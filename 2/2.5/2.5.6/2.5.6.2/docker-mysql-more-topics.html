<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2.5.6.2 关于使用 Docker 部署 MySQL 服务的更多主题 | MySQL 8.0 中文参考手册</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8380975615223941" crossorigin="anonymous"></script>
    <meta name="description" content="对官方参考手册的翻译，持续翻译中">
    <meta name="keywords" content="mysql,sql,innodb">
    
    <link rel="preload" href="/assets/css/0.styles.aa2ad065.css" as="style"><link rel="preload" href="/assets/js/app.e47f27d9.js" as="script"><link rel="preload" href="/assets/js/2.47a142bd.js" as="script"><link rel="preload" href="/assets/js/105.ce774c27.js" as="script"><link rel="prefetch" href="/assets/js/10.deffa529.js"><link rel="prefetch" href="/assets/js/100.c67a8722.js"><link rel="prefetch" href="/assets/js/101.c3634f08.js"><link rel="prefetch" href="/assets/js/102.37559783.js"><link rel="prefetch" href="/assets/js/103.0f740477.js"><link rel="prefetch" href="/assets/js/104.ee30c467.js"><link rel="prefetch" href="/assets/js/106.7fc2af77.js"><link rel="prefetch" href="/assets/js/107.463506c5.js"><link rel="prefetch" href="/assets/js/108.dcbb7dfc.js"><link rel="prefetch" href="/assets/js/109.1748dba3.js"><link rel="prefetch" href="/assets/js/11.ed99e55c.js"><link rel="prefetch" href="/assets/js/110.05ceba3e.js"><link rel="prefetch" href="/assets/js/111.1e60f786.js"><link rel="prefetch" href="/assets/js/112.2aa6eb42.js"><link rel="prefetch" href="/assets/js/113.dd9afbf2.js"><link rel="prefetch" href="/assets/js/114.4ca23bb4.js"><link rel="prefetch" href="/assets/js/115.78eb1564.js"><link rel="prefetch" href="/assets/js/116.cbc996de.js"><link rel="prefetch" href="/assets/js/117.be839d0b.js"><link rel="prefetch" href="/assets/js/118.45d15684.js"><link rel="prefetch" href="/assets/js/119.7871ef4d.js"><link rel="prefetch" href="/assets/js/12.0db08d73.js"><link rel="prefetch" href="/assets/js/120.62529e4f.js"><link rel="prefetch" href="/assets/js/121.05361e30.js"><link rel="prefetch" href="/assets/js/122.afea5e3e.js"><link rel="prefetch" href="/assets/js/123.393ee2e4.js"><link rel="prefetch" href="/assets/js/124.a6ba6046.js"><link rel="prefetch" href="/assets/js/125.bc734137.js"><link rel="prefetch" href="/assets/js/126.69749199.js"><link rel="prefetch" href="/assets/js/127.a5467ca1.js"><link rel="prefetch" href="/assets/js/128.651d3c34.js"><link rel="prefetch" href="/assets/js/129.d8ae52e9.js"><link rel="prefetch" href="/assets/js/13.4741f569.js"><link rel="prefetch" href="/assets/js/130.75badf13.js"><link rel="prefetch" href="/assets/js/131.f12a1352.js"><link rel="prefetch" href="/assets/js/132.cd0f3206.js"><link rel="prefetch" href="/assets/js/133.a07a6baa.js"><link rel="prefetch" href="/assets/js/134.e8723244.js"><link rel="prefetch" href="/assets/js/135.3e7956a7.js"><link rel="prefetch" href="/assets/js/136.bc6faae5.js"><link rel="prefetch" href="/assets/js/137.518c8687.js"><link rel="prefetch" href="/assets/js/138.b66fb80f.js"><link rel="prefetch" href="/assets/js/139.9033e89e.js"><link rel="prefetch" href="/assets/js/14.182f7e04.js"><link rel="prefetch" href="/assets/js/140.48a183cb.js"><link rel="prefetch" href="/assets/js/141.076c03a3.js"><link rel="prefetch" href="/assets/js/142.15a4b15e.js"><link rel="prefetch" href="/assets/js/143.db514f87.js"><link rel="prefetch" href="/assets/js/144.72707222.js"><link rel="prefetch" href="/assets/js/145.e289b3d5.js"><link rel="prefetch" href="/assets/js/146.54fbefa1.js"><link rel="prefetch" href="/assets/js/147.2cc6048f.js"><link rel="prefetch" href="/assets/js/15.3865ed44.js"><link rel="prefetch" href="/assets/js/16.e4b67b78.js"><link rel="prefetch" href="/assets/js/17.7681fa5c.js"><link rel="prefetch" href="/assets/js/18.65f8210b.js"><link rel="prefetch" href="/assets/js/19.e67927c0.js"><link rel="prefetch" href="/assets/js/20.7f3f8669.js"><link rel="prefetch" href="/assets/js/21.db0160f6.js"><link rel="prefetch" href="/assets/js/22.c9938d92.js"><link rel="prefetch" href="/assets/js/23.0145e3cb.js"><link rel="prefetch" href="/assets/js/24.36e54bee.js"><link rel="prefetch" href="/assets/js/25.a7bbf870.js"><link rel="prefetch" href="/assets/js/26.601f8c7f.js"><link rel="prefetch" href="/assets/js/27.8c368242.js"><link rel="prefetch" href="/assets/js/28.73980f6a.js"><link rel="prefetch" href="/assets/js/29.d6db5bad.js"><link rel="prefetch" href="/assets/js/3.3bdb09ed.js"><link rel="prefetch" href="/assets/js/30.c1f26766.js"><link rel="prefetch" href="/assets/js/31.12841a99.js"><link rel="prefetch" href="/assets/js/32.125a41a6.js"><link rel="prefetch" href="/assets/js/33.968fcae4.js"><link rel="prefetch" href="/assets/js/34.40a92121.js"><link rel="prefetch" href="/assets/js/35.4bdb796f.js"><link rel="prefetch" href="/assets/js/36.76646ad0.js"><link rel="prefetch" href="/assets/js/37.2182e0c6.js"><link rel="prefetch" href="/assets/js/38.2abe4c4e.js"><link rel="prefetch" href="/assets/js/39.04d0c0a8.js"><link rel="prefetch" href="/assets/js/4.87a5081d.js"><link rel="prefetch" href="/assets/js/40.98039617.js"><link rel="prefetch" href="/assets/js/41.b35663a5.js"><link rel="prefetch" href="/assets/js/42.f04819f3.js"><link rel="prefetch" href="/assets/js/43.eb67f536.js"><link rel="prefetch" href="/assets/js/44.daff5acc.js"><link rel="prefetch" href="/assets/js/45.8cafa1c2.js"><link rel="prefetch" href="/assets/js/46.2b236515.js"><link rel="prefetch" href="/assets/js/47.45db49f5.js"><link rel="prefetch" href="/assets/js/48.d7b86fda.js"><link rel="prefetch" href="/assets/js/49.767ab145.js"><link rel="prefetch" href="/assets/js/5.966e3f4e.js"><link rel="prefetch" href="/assets/js/50.4469796e.js"><link rel="prefetch" href="/assets/js/51.926b10c8.js"><link rel="prefetch" href="/assets/js/52.1f804b89.js"><link rel="prefetch" href="/assets/js/53.7db8560c.js"><link rel="prefetch" href="/assets/js/54.cb854ae1.js"><link rel="prefetch" href="/assets/js/55.4cbee9d4.js"><link rel="prefetch" href="/assets/js/56.fc8313f5.js"><link rel="prefetch" href="/assets/js/57.76820eb2.js"><link rel="prefetch" href="/assets/js/58.4ca84f9d.js"><link rel="prefetch" href="/assets/js/59.3a2a2bcb.js"><link rel="prefetch" href="/assets/js/6.e63309a1.js"><link rel="prefetch" href="/assets/js/60.16f0b745.js"><link rel="prefetch" href="/assets/js/61.ffd8344d.js"><link rel="prefetch" href="/assets/js/62.35fb767b.js"><link rel="prefetch" href="/assets/js/63.a30f2ecc.js"><link rel="prefetch" href="/assets/js/64.1f19390b.js"><link rel="prefetch" href="/assets/js/65.d52206ca.js"><link rel="prefetch" href="/assets/js/66.e75a701d.js"><link rel="prefetch" href="/assets/js/67.c57cf858.js"><link rel="prefetch" href="/assets/js/68.2c732015.js"><link rel="prefetch" href="/assets/js/69.4d7be902.js"><link rel="prefetch" href="/assets/js/7.0290c42d.js"><link rel="prefetch" href="/assets/js/70.3bc7b3ce.js"><link rel="prefetch" href="/assets/js/71.f3eb4d98.js"><link rel="prefetch" href="/assets/js/72.5bdde9eb.js"><link rel="prefetch" href="/assets/js/73.2ce336c3.js"><link rel="prefetch" href="/assets/js/74.9580a068.js"><link rel="prefetch" href="/assets/js/75.b30ba930.js"><link rel="prefetch" href="/assets/js/76.83f3b8bb.js"><link rel="prefetch" href="/assets/js/77.e4b48f96.js"><link rel="prefetch" href="/assets/js/78.d5ee25d4.js"><link rel="prefetch" href="/assets/js/79.602ebc3f.js"><link rel="prefetch" href="/assets/js/8.f0b630de.js"><link rel="prefetch" href="/assets/js/80.f4fc83f8.js"><link rel="prefetch" href="/assets/js/81.81cdb8ef.js"><link rel="prefetch" href="/assets/js/82.417089c4.js"><link rel="prefetch" href="/assets/js/83.330d3269.js"><link rel="prefetch" href="/assets/js/84.c9bf1a9d.js"><link rel="prefetch" href="/assets/js/85.1cb5b3e7.js"><link rel="prefetch" href="/assets/js/86.b564fc45.js"><link rel="prefetch" href="/assets/js/87.73b334e7.js"><link rel="prefetch" href="/assets/js/88.fe7655d8.js"><link rel="prefetch" href="/assets/js/89.ec3ac391.js"><link rel="prefetch" href="/assets/js/9.29102432.js"><link rel="prefetch" href="/assets/js/90.d172b4a0.js"><link rel="prefetch" href="/assets/js/91.471d1de4.js"><link rel="prefetch" href="/assets/js/92.e7776e79.js"><link rel="prefetch" href="/assets/js/93.da2515d1.js"><link rel="prefetch" href="/assets/js/94.ec94c79a.js"><link rel="prefetch" href="/assets/js/95.c62319ef.js"><link rel="prefetch" href="/assets/js/96.c59ea3f5.js"><link rel="prefetch" href="/assets/js/97.01a0f2a7.js"><link rel="prefetch" href="/assets/js/98.c074e536.js"><link rel="prefetch" href="/assets/js/99.fe7354b8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.aa2ad065.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/favicon.ico" alt="MySQL 8.0 中文参考手册" class="logo"> <span class="site-name can-hide">MySQL 8.0 中文参考手册</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://www.bookhub.tech" target="_blank" rel="noopener noreferrer" class="nav-link external">
  BookHub 首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://docs.bookhub.tech" target="_blank" rel="noopener noreferrer" class="nav-link external">
  中文文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://pdf.bookhub.tech" target="_blank" rel="noopener noreferrer" class="nav-link external">
  计算机书库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/dev2007/mysql8-manual" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://www.bookhub.tech" target="_blank" rel="noopener noreferrer" class="nav-link external">
  BookHub 首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://docs.bookhub.tech" target="_blank" rel="noopener noreferrer" class="nav-link external">
  中文文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://pdf.bookhub.tech" target="_blank" rel="noopener noreferrer" class="nav-link external">
  计算机书库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/dev2007/mysql8-manual" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">MySQL 翻译说明</a></li><li><a href="/mysql.html" class="sidebar-link">前言和法律条款</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/1/introduction" class="sidebar-heading clickable"><span>基本信息</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/2/installing" class="sidebar-heading clickable open"><span>MySQL 的安装和升级</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/2/2.1/general-installation-issues" class="sidebar-heading clickable"><span>通用安装指南</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/2/2.2/binary-installation.html" class="sidebar-link">使用通用二进制文件在 Unix/Linux 上安装 MySQL</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/2/2.3/windows-installation" class="sidebar-heading clickable"><span>在 Microsoft Windows 上安装 MySQL</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/2/2.4/macos-installation" class="sidebar-heading clickable"><span>在 macOS 上安装 MySQL</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/2/2.5/linux-installation" class="sidebar-heading clickable open"><span>在 Linux 上安装 MySQL</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/2/2.5/2.5.1/linux-installation-yum-repo.html" class="sidebar-link">使用 MySQL Yum 存储库在 Linux 上安装 MySQL</a></li><li><a href="/2/2.5/2.5.2/linux-installation-apt-repo.html" class="sidebar-link">使用 MySQL APT 存储库在 Linux 上安装 MySQL</a></li><li><a href="/2/2.5/2.5.3/linux-installation-sles-repo.html" class="sidebar-link">使用 MySQL SLES 仓库在 Linux 上安装 MySQL</a></li><li><a href="/2/2.5/2.5.4/linux-installation-rpm.html" class="sidebar-link">使用 Oracle 的 RPM 包在 Linux 上安装 MySQL</a></li><li><a href="/2/2.5/2.5.5/linux-installation-debian.html" class="sidebar-link">使用 Oracle 的 Debian 软件包在 Linux上 安装 MySQL</a></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/2/2.5/2.5.6/linux-installation-docker" class="sidebar-heading clickable open"><span>使用 Docker 在 Linux 上部署 MySQL</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html" class="sidebar-link">使用 Docker 部署 MySQL 服务器的基本步骤</a></li><li><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html" aria-current="page" class="active sidebar-link">关于使用 Docker 部署 MySQL 服务的更多主题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#为-docker-优化的-mysql-安装" class="sidebar-link">为 Docker 优化的 MySQL 安装</a></li><li class="sidebar-sub-header"><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#配置-mysql-服务器" class="sidebar-link">配置 MySQL 服务器</a></li><li class="sidebar-sub-header"><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#持久化数据和配置更改" class="sidebar-link">持久化数据和配置更改</a></li><li class="sidebar-sub-header"><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#运行其他初始化脚本" class="sidebar-link">运行其他初始化脚本</a></li><li class="sidebar-sub-header"><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#从另一个-docker-容器应用连接到-mysql" class="sidebar-link">从另一个 Docker 容器应用连接到 MySQL</a></li><li class="sidebar-sub-header"><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#服务器错误日志" class="sidebar-link">服务器错误日志</a></li><li class="sidebar-sub-header"><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#docker-中使用-mysql-企业备份" class="sidebar-link">Docker 中使用 MySQL 企业备份</a></li><li class="sidebar-sub-header"><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#docker-中使用-mysqldump" class="sidebar-link">Docker 中使用 mysqldump</a></li><li class="sidebar-sub-header"><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#已知问题" class="sidebar-link">已知问题</a></li><li class="sidebar-sub-header"><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#docker-环境变量" class="sidebar-link">Docker 环境变量</a></li></ul></li></ul></section></li><li><a href="/2/2.5/2.5.7/linux-installation-native.html" class="sidebar-link">从本地软件仓库在 Linux 上安装 MySQL</a></li><li><a href="/2/2.5/2.5.8/linux-installation-juju.html" class="sidebar-link">在有 Juju 的 Linux 上安装 MySQL</a></li><li><a href="/2/2.5/2.5.9/using-systemd.html" class="sidebar-link">使用 systemd 管理 MySQL 服务器</a></li></ul></section></li><li><a href="/2/2.6/uln-installation.html" class="sidebar-link">使用不可破坏的 Linux 网络（ULN）安装 MySQL</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/2/2.7/solaris-installation" class="sidebar-heading clickable"><span>在 Solaris 上安装 MySQL</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/2/2.8/freebsd-installation.html" class="sidebar-link">在 FreeBSD 上安装 MySQL</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/2/2.9/source-installation" class="sidebar-heading clickable"><span>从源代码安装 MySQL</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/2/2.10/postinstallation" class="sidebar-heading clickable"><span>安装后设置和测试</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/2/2.11/upgrading" class="sidebar-heading clickable"><span>升级 MySQL</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/2/2.12/downgrading.html" class="sidebar-link">降级 MySQL</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/2/2.13/perl-support" class="sidebar-heading clickable"><span>Perl 安装说明</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/3/tutorial" class="sidebar-heading clickable"><span>教程</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_2-5-6-2-关于使用-docker-部署-mysql-服务的更多主题"><a href="#_2-5-6-2-关于使用-docker-部署-mysql-服务的更多主题" class="header-anchor">#</a> 2.5.6.2 关于使用 Docker 部署 MySQL 服务的更多主题</h1> <div class="custom-block tip"><p class="custom-block-title">注意</p> <p>以下大多数示例命令都将 <code>mysql/mysql-server</code> 作为 Docker 镜像仓库（如 <strong>docker pull</strong> 和 <strong>docker run</strong> 命令）；如果你的镜像来自另一个仓库，请将其替换为 <code>container-registry.oracle.com/mysql/enterprise</code> 服务器，用于从 Oracle 容器注册表（OCR）下载的 MySQL 企业版镜像，或从<a href="https://support.oracle.com/" target="_blank" rel="noopener noreferrer">我的 Oracle 支持<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>下载的，用于 MySQL 企业版镜像的 <code>mysql/enterprise-server</code>。</p></div> <ul><li><p><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#为-Docker-优化的-MySQL-安装">为 Docker 优化的 MySQL 安装</a></p></li> <li><p><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#配置-MySQL-服务器">配置 MySQL 服务器</a></p></li> <li><p><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#持久化数据和配置更改">持久化数据和配置更改</a></p></li> <li><p><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#运行其他初始化脚本">运行其他初始化脚本</a></p></li> <li><p><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#从另一个-Docker-容器应用连接到-MySQL">从另一个 Docker 容器应用连接到 MySQL</a></p></li> <li><p><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#服务器错误日志">服务器错误日志</a></p></li> <li><p><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#Docker-中使用-MySQL-企业备份">Docker 中使用 MySQL 企业备份</a></p></li> <li><p><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#Docker-中使用-mysqldump">Docker 中使用 mysqldump</a></p></li> <li><p><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#已知问题">已知问题</a></p></li> <li><p><a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#Docker-环境变量">Docker 环境变量</a></p></li></ul> <h2 id="为-docker-优化的-mysql-安装"><a href="#为-docker-优化的-mysql-安装" class="header-anchor">#</a> 为 Docker 优化的 MySQL 安装</h2> <p>针对 MySQL 的 Docker 镜像针对代码大小进行了优化，这意味着它们只包含与大多数在 Docker 容器中运行 MySQL 实例的用户相关的关键组件。MySQL Docker 安装与普通非 Docker 的安装在以下方面有所不同：</p> <ul><li><p>包含的二进制文件限于：</p> <ul><li><p><code>/usr/bin/my_print_defaults</code></p></li> <li><p><code>/usr/bin/mysql</code></p></li> <li><p><code>/usr/bin/mysql_config</code></p></li> <li><p><code>/usr/bin/mysql_install_db</code></p></li> <li><p><code>/usr/bin/mysql_tzinfo_to_sql</code></p></li> <li><p><code>/usr/bin/mysql_upgrade</code></p></li> <li><p><code>/usr/bin/mysqladmin</code></p></li> <li><p><code>/usr/bin/mysqlcheck</code></p></li> <li><p><code>/usr/bin/mysqldump</code></p></li> <li><p><code>/usr/bin/mysqlpump</code></p></li> <li><p><code>/usr/bin/mysqlbackup</code> (仅用于 MySQL 企业版 8.0 )</p></li> <li><p><code>/usr/sbin/mysqld</code></p></li></ul></li> <li><p>所有二进制文件被剥离；它们不包含调试信息。</p></li></ul> <h2 id="配置-mysql-服务器"><a href="#配置-mysql-服务器" class="header-anchor">#</a> 配置 MySQL 服务器</h2> <p>启动 MySQL Docker 容器时，可以通过 <strong>docker run</strong> 命令将配置选项传递给服务器。例如：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span> mysql1 <span class="token parameter variable">-d</span> mysql/mysql-server:tag --character-set-server<span class="token operator">=</span>utf8mb4 --collation-server<span class="token operator">=</span>utf8mb4_col
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>该命令启动 MySQL 服务器，将 <code>utf8mb4</code> 作为默认字符集，并将 <code>utf8mb4_col</code> 作为数据库的默认排序规则。</p> <p>配置 MySQL 服务器的另一种方法是准备一个配置文件，并将其安装在容器中服务器配置文件的位置。有关详细信息，参阅<a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#持久化数据和配置更改">持久化数据和配置更改</a>。</p> <h2 id="持久化数据和配置更改"><a href="#持久化数据和配置更改" class="header-anchor">#</a> 持久化数据和配置更改</h2> <p>Docker 容器原则上是短暂的，如果容器被删除或损坏，任何数据或配置都将丢失（参阅此处的<a href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/" target="_blank" rel="noopener noreferrer">讨论<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）。<a href="https://docs.docker.com/engine/admin/volumes/volumes/" target="_blank" rel="noopener noreferrer">Docker 卷<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>提供了一种持久化 Docker 容器内创建的数据的机制。在初始化时，MySQL 服务器容器为服务器数据目录创建一个 Docker 卷。容器上 <strong>docker inspect</strong> 命令的 JSON 输出包括一个 <code>Mount</code> 键，其值提供数据目录卷的信息：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$<span class="token operator">&gt;</span> <span class="token function">docker</span> inspect mysql1
<span class="token punctuation">..</span>.
 <span class="token string">&quot;Mounts&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;Type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;volume&quot;</span>,
                <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;4f2d463cfc4bdd4baebcb098c97d7da3337195ed2c6572bc0b89f7e845d27652&quot;</span>,
                <span class="token string">&quot;Source&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/volumes/4f2d463cfc4bdd4baebcb098c97d7da3337195ed2c6572bc0b89f7e845d27652/_data&quot;</span>,
                <span class="token string">&quot;Destination&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/mysql&quot;</span>,
                <span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span>,
                <span class="token string">&quot;Mode&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
                <span class="token string">&quot;RW&quot;</span><span class="token builtin class-name">:</span> true,
                <span class="token string">&quot;Propagation&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>,
<span class="token punctuation">..</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>输出显示源目录 <code>/var/lib/docker/volumes/4f2d463cfc4bdd4baebcb098c97d7da3337195ed2c6572bc0b89f7e845d27652/_data</code>（其中数据保存在主机上）已安装在容器内的服务器数据目录 <code>/var/lib/mysql</code>。</p> <p>另一种保存数据的方法是在创建容器时使用 <code>--mount</code> 选项绑定挂载主机目录。可以使用相同的技术来持久化服务器的配置。以下命令创建一个 MySQL 服务器容器，并绑定数据目录和服务器配置文件：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span><span class="token operator">=</span>mysql1 <span class="token punctuation">\</span>
<span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/path-on-host-machine/my.cnf,dst<span class="token operator">=</span>/etc/my.cnf <span class="token punctuation">\</span>
<span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/path-on-host-machine/datadir,dst<span class="token operator">=</span>/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> mysql/mysql-server:tag
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>该命令在 <code>/etc/my.cnf</code>（容器内的服务器配置文件）处挂载 <code>path-on-host-machine/my.cnf</code>，并在主机 <code>/datadir/var/lib/mysql</code>（容器内数据目录）上挂载 <code>path-on-host-machine/datadir</code>。绑定挂载工作必须满足以下条件：</p> <ul><li>配置文件 <code>path-on-host-machine/my.cnf</code> 必须已经存在，并且必须包含用户 <code>mysql</code> 启动服务器的规范：</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
<span class="token assign-left variable">user</span><span class="token operator">=</span>mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>你还可以在文件中包含其他服务器配置选项。</p> <ul><li>数据目录 <code>path-on-host-machine/datadir</code> 必须已经存在。要进行服务器初始化，目录必须为空。你还可以挂载预先填充了数据的目录，并用它启动服务器；但是，你必须确保使用与创建数据的服务器相同的配置启动 Docker 容器，并且在启动容器时安装所需的任何主机文件或目录。</li></ul> <h2 id="运行其他初始化脚本"><a href="#运行其他初始化脚本" class="header-anchor">#</a> 运行其他初始化脚本</h2> <p>如果有任何 <code>.sh</code> 或 <code>.sql</code> 脚本要在创建后立即在数据库上运行，则可以将它们放入主机目录中，然后将目录挂载到容器中的 <code>/docker-entrypoint-initdb.d/</code> 位置。例如：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span><span class="token operator">=</span>mysql1 <span class="token punctuation">\</span>
<span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/path-on-host-machine/scripts/,dst<span class="token operator">=</span>/docker-entrypoint-initdb.d/ <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> mysql/mysql-server:tag
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="从另一个-docker-容器应用连接到-mysql"><a href="#从另一个-docker-容器应用连接到-mysql" class="header-anchor">#</a> 从另一个 Docker 容器应用连接到 MySQL</h2> <p>通过设置 Docker 网络，你可以允许多个 Docker 容器相互通信，以便另一个 Docker 容器中的客户端应用程序可以访问服务器容器中的 MySQL 服务器。首先，创建 Docker 网络：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> network create my-custom-net
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后，在创建和启动服务器和客户机容器时，使用 <code>--network</code> 选项将它们放在你创建的网络上。例如：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span><span class="token operator">=</span>mysql1 <span class="token parameter variable">--network</span><span class="token operator">=</span>my-custom-net <span class="token parameter variable">-d</span> mysql/mysql-server
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span><span class="token operator">=</span>myapp1 <span class="token parameter variable">--network</span><span class="token operator">=</span>my-custom-net <span class="token parameter variable">-d</span> myapp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后，<code>myapp1</code> 容器可以使用 <code>mysql1</code> 主机名连接到 <code>mysql1</code> 容器，反之亦然，因为 Docker 会自动为给定的容器名称设置 DNS。在下面的示例中，我们从 <code>myapp1</code> 容器内部运行 <a href="/4/4.5/4.5.1/mysql.html">mysql</a> 客户端，以连接到自己容器中的主机 <code>mysql1</code>：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> myapp1 mysql <span class="token parameter variable">--host</span><span class="token operator">=</span>mysql1 <span class="token parameter variable">--user</span><span class="token operator">=</span>myuser <span class="token parameter variable">--password</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>有关容器的其他网络技术，参阅 Docker 文档中的 <a href="https://docs.docker.com/engine/userguide/networking/" target="_blank" rel="noopener noreferrer">Docker 容器网络<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>部分。</p> <h2 id="服务器错误日志"><a href="#服务器错误日志" class="header-anchor">#</a> 服务器错误日志</h2> <p>当使用服务器容器首次启动 MySQL 服务器时，如果以下任一条件为真，则不会生成服务器错误日志：</p> <ul><li><p>已装载主机的服务器配置文件，但该文件不包含系统变量 <a href="/5/5.1/5.1.8/server-system-variables.html">log_error</a>（参阅绑定装载服务器配置文件时的<a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#持久化数据和配置更改">持久数据和配置更改</a>）。</p></li> <li><p>来自主机的服务器配置文件尚未挂载，但 Docker 环境变量 <a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#Docker-环境变量">MYSQL_LOG_CONSOLE</a> 为true（这是 MYSQL 8.0 服务器容器的默认状态）。然后，MySQL 服务器的错误日志被重定向到 stderr，以便错误日志进入 Docker 容器的日志，并可以使用 <code>docker logs mysqld-container</code> 容器命令查看。</p></li></ul> <p>要使 MySQL 服务器在这两个条件之一为真时生成错误日志，请使用 <a href="/5/5.1/5.1.7/server-options.html">--log-error</a> 选项将<a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#配置-MySQL-服务器">配置服务器</a>为在容器内的特定位置生成错误日志。要持久化错误日志，请在容器内的错误日志位置安装主机文件，如<a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#持久化数据和配置更改">持久数据和配置更改</a>中所述。但是，你必须确保容器中的 MySQL 服务器对装载的主机文件具有写访问权限。</p> <h2 id="docker-中使用-mysql-企业备份"><a href="#docker-中使用-mysql-企业备份" class="header-anchor">#</a> Docker 中使用 MySQL 企业备份</h2> <p><a href="https://dev.mysql.com/doc/mysql-enterprise-backup/8.0/en/" target="_blank" rel="noopener noreferrer">MySQL 企业备份<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是 MySQL 服务器的商业授权备份实用程序，可与 <a href="https://dev.mysql.com/doc/mysql-enterprise-backup/8.0/en/" target="_blank" rel="noopener noreferrer">MySQL 企业版<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>一起使用。MySQL 企业备份包含在 MySQL 企业版的 Docker 安装中。</p> <p>在下面的示例中，我们假设你已经在 Docker 容器中运行了 MySQL 服务器（参阅<a href="/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html">章节 2.5.6.1，“使用 Docker 部署 MySQL 服务器的基本步骤”</a>，了解如何使用 Docker 启动 MySQL 服务器实例）。为了使 MySQL 企业备份能够备份 MySQL 服务器，它必须能够访问服务器的数据目录。例如，可以通过在启动服务器时<a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#持久化数据和配置更改">将主机目录绑定到 MySQL 服务器的数据目录</a>来实现：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span><span class="token operator">=</span>mysqlserver <span class="token punctuation">\</span>
<span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/path-on-host-machine/datadir/,dst<span class="token operator">=</span>/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> mysql/enterprise-server:8.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>使用此命令，MySQL 服务器将使用 MySQL 企业版的 Docker 镜像启动，主机目录 <em>/path-on-host-machine/datadir/</em> 已安装到服务器容器内的服务器数据目录（<code>/var/lib/mysql</code>）。我们还假设，在服务器启动后，还为 MySQL 企业备份设置了访问服务器所需的权限（有关详细信息，参阅<a href="/4/4.1/4.1.2/mysqlbackup.privileges">向备份管理员授予 MySQL 权限</a>）。使用以下步骤备份和恢复 MySQL 服务器实例。</p> <p>要使用 Docker 中使用 MySQL 企业备份在 Docker 容器中运行的 MySQL 服务器实例，请执行以下步骤：</p> <ol><li>在运行 MySQL 服务器容器的同一主机上，使用 MySQL 企业版的镜像启动另一个容器，以使用 MySQL 企业备份命令 <a href="/19/19.1/backup-commands-backup">backup-to-image</a> 执行备份。使用我们在上一步中创建的绑定挂载提供对服务器数据目录的访问。此外，将主机目录（在本例中为 <code>/path-on-host-machine/backups/</code>）挂载到容器中的备份存储文件夹（在本示例中为 <code>/data/backups</code>），以持久化我们正在创建的备份。以下是此步骤的示例命令，其中 MySQL 企业备份使用从<a href="https://support.oracle.com/" target="_blank" rel="noopener noreferrer">我的 Oracle 支持<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>下载的 Docker 镜像启动）：</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$<span class="token operator">&gt;</span> <span class="token function">docker</span> run <span class="token punctuation">\</span>
<span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/path-on-host-machine/datadir/,dst<span class="token operator">=</span>/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/path-on-host-machine/backups/,dst<span class="token operator">=</span>/data/backups <span class="token punctuation">\</span>
<span class="token parameter variable">--rm</span> mysql/enterprise-server:8.0 <span class="token punctuation">\</span>
mysqlbackup <span class="token parameter variable">-umysqlbackup</span> <span class="token parameter variable">-ppassword</span> --backup-dir<span class="token operator">=</span>/tmp/backup-tmp --with-timestamp <span class="token punctuation">\</span>
--backup-image<span class="token operator">=</span>/data/backups/db.mbi backup-to-image

<span class="token punctuation">[</span>Entrypoint<span class="token punctuation">]</span> MySQL Docker Image <span class="token number">8.0</span>.11-1.1.5
MySQL Enterprise Backup version <span class="token number">8.0</span>.11 Linux-4.1.12-61.1.16.el7uek.x86_64-x86_64 <span class="token punctuation">[</span><span class="token number">2018</span>-04-08  07:06:45<span class="token punctuation">]</span>
Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2003</span>, <span class="token number">2018</span>, Oracle and/or its affiliates. All Rights Reserved.

<span class="token number">180921</span> <span class="token number">17</span>:27:25 MAIN    INFO: A thread created with Id <span class="token string">'140594390935680'</span>
<span class="token number">180921</span> <span class="token number">17</span>:27:25 MAIN    INFO: Starting with following <span class="token builtin class-name">command</span> line <span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.

-------------------------------------------------------------
   Parameters Summary
-------------------------------------------------------------
   Start LSN                  <span class="token builtin class-name">:</span> <span class="token number">29615616</span>
   End LSN                    <span class="token builtin class-name">:</span> <span class="token number">29651854</span>
-------------------------------------------------------------

mysqlbackup completed OK<span class="token operator">!</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>重要的是检查 <strong>mysqlbackup</strong> 输出的结尾，以确保备份已成功完成。</p> <ol start="2"><li>一旦备份作业完成，容器就会退出，并且使用 <code>--rm</code> 选项启动它，容器在退出后就会被删除。镜像备份已经创建，可以在上一步挂载的用于保存备份的主机目录中找到，如下所示:</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$<span class="token operator">&gt;</span> <span class="token function">ls</span> /tmp/backups
db.mbi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>要在 Docker 容器中使用 MySQL 企业版备份恢复 MySQL 服务器实例，请遵循下面列出的步骤:</p> <ol><li>停止 MySQL 服务器容器，它也会停止 MySQL 服务器运行:</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> stop mysqlserver
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>在主机上，删除 MySQL 服务器数据目录的绑定挂载中的所有内容:</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">rm</span> <span class="token parameter variable">-rf</span> /path-on-host-machine/datadir/*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="3"><li>启动一个带有 MySQL 企业版镜像的容器，使用 MySQL 企业版备份命令 <a href="/19/19.3/backup-commands-restore">copy-back-apply-log</a> 执行恢复。绑定挂载服务器的数据目录和备份的存储文件夹，就像我们备份服务器时所做的那样:</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$<span class="token operator">&gt;</span> <span class="token function">docker</span> run <span class="token punctuation">\</span>
<span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/path-on-host-machine/datadir/,dst<span class="token operator">=</span>/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/path-on-host-machine/backups/,dst<span class="token operator">=</span>/data/backups <span class="token punctuation">\</span>
<span class="token parameter variable">--rm</span> mysql/enterprise-server:8.0 <span class="token punctuation">\</span>
mysqlbackup --backup-dir<span class="token operator">=</span>/tmp/backup-tmp --with-timestamp <span class="token punctuation">\</span>
<span class="token parameter variable">--datadir</span><span class="token operator">=</span>/var/lib/mysql --backup-image<span class="token operator">=</span>/data/backups/db.mbi copy-back-and-apply-log

<span class="token punctuation">[</span>Entrypoint<span class="token punctuation">]</span> MySQL Docker Image <span class="token number">8.0</span>.11-1.1.5
MySQL Enterprise Backup version <span class="token number">8.0</span>.11 Linux-4.1.12-61.1.16.el7uek.x86_64-x86_64 <span class="token punctuation">[</span><span class="token number">2018</span>-04-08  07:06:45<span class="token punctuation">]</span>
Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2003</span>, <span class="token number">2018</span>, Oracle and/or its affiliates. All Rights Reserved.

<span class="token number">180921</span> <span class="token number">22</span>:06:52 MAIN    INFO: A thread created with Id <span class="token string">'139768047519872'</span>
<span class="token number">180921</span> <span class="token number">22</span>:06:52 MAIN    INFO: Starting with following <span class="token builtin class-name">command</span> line <span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.
<span class="token number">180921</span> <span class="token number">22</span>:06:52 PCR1    INFO: We were able to parse ibbackup_logfile up to
          lsn <span class="token number">29680612</span>.
<span class="token number">180921</span> <span class="token number">22</span>:06:52 PCR1    INFO: Last MySQL binlog <span class="token function">file</span> position <span class="token number">0</span> <span class="token number">155</span>, <span class="token function">file</span> name binlog.000003
<span class="token number">180921</span> <span class="token number">22</span>:06:52 PCR1    INFO: The first data <span class="token function">file</span> is <span class="token string">'/var/lib/mysql/ibdata1'</span>
                              and the new created log files are at <span class="token string">'/var/lib/mysql'</span>
<span class="token number">180921</span> <span class="token number">22</span>:06:52 MAIN    INFO: No Keyring <span class="token function">file</span> to process.
<span class="token number">180921</span> <span class="token number">22</span>:06:52 MAIN    INFO: Apply-log operation completed successfully.
<span class="token number">180921</span> <span class="token number">22</span>:06:52 MAIN    INFO: Full Backup has been restored successfully.

mysqlbackup completed OK<span class="token operator">!</span> with <span class="token number">3</span> warnings
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>一旦备份作业完成，容器就会退出，并且在启动它时使用 <code>--rm</code> 选项，它会在退出后被删除。</p> <ol start="4"><li>重启服务器容器，服务器容器也会重启恢复的服务器，可以使用以下命令:</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> restart mysqlserver
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>或者，在恢复的数据目录上启动一个新的 MySQL 服务器，如下所示:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span><span class="token operator">=</span>mysqlserver2 <span class="token punctuation">\</span>
<span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/path-on-host-machine/datadir/,dst<span class="token operator">=</span>/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> mysql/enterprise-server:8.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="docker-中使用-mysqldump"><a href="#docker-中使用-mysqldump" class="header-anchor">#</a> Docker 中使用 mysqldump</h2> <p>除了<a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#Docker-中使用-MySQL-企业备份">使用 MySQL 企业备份来备份运行在 Docker 容器中的 MySQL 服务器</a>，你还可以使用运行在 Docker 容器中的 <a href="/4/4.5/4.5.4/mysqldump">mysqldump</a> 工具来对服务器进行逻辑备份。</p> <p>下面的说明假设你已经在 Docker 容器中运行了一个 MySQL 服务器，并且当容器第一次启动时，一个主机目录 <em>/path-on-host-machine/datadir/</em> 已经挂载到服务器的数据目录 <code>/var/lib/mysql</code> 上(详细信息参阅<a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#持久化数据和配置更改">在 MySQL 服务器的数据目录上绑定挂载一个主机目录</a>)，该目录包含Unix套接字文件，<a href="/4/4.5/4.5.4/mysqldump">mysqldump</a> 和 <a href="/4/4.5/4.5.1/mysql">mysql</a> 可以通过该套接字文件连接到服务器。我们还假设，在服务器启动之后，创建了一个具有适当权限的用户(在本例中为 <code>admin</code>)， mysqldump 可以通过该用户访问服务器。备份和恢复 MySQL 服务器数据的操作步骤如下:</p> <p><em>在 Docker 中使用 <a href="/4/4.5/4.5.4/mysqldump">mysqldump</a> 备份 MySQL 服务器数据:</em></p> <ol><li>在 MySQL 服务器容器运行的同一台主机上，用 MySQL 服务器的镜像启动另一个容器，使用 <a href="/4/4.5/4.5.4/mysqldump">mysqldump</a> 实用程序执行备份(有关其功能、选项和限制，参阅该实用程序的文档)。通过绑定挂载 <em>/path-on-host-machine/datadir/</em> 提供对服务器数据目录的访问。另外，将一个主机目录(本例中为 <em>/path-on-host-machine/backups/</em>)挂载到容器内用于备份的存储文件夹上(本例中使用 <code>/data/backups</code>)，以持久化所创建的备份。下面是使用此设置备份服务器上所有数据库的示例命令:</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$<span class="token operator">&gt;</span> <span class="token function">docker</span> run <span class="token parameter variable">--entrypoint</span> <span class="token string">&quot;/bin/sh&quot;</span> <span class="token punctuation">\</span> 
<span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/path-on-host-machine/datadir/,dst<span class="token operator">=</span>/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/path-on-host-machine/backups/,dst<span class="token operator">=</span>/data/backups <span class="token punctuation">\</span>
<span class="token parameter variable">--rm</span> mysql/mysql-server:8.0 <span class="token punctuation">\</span>
<span class="token parameter variable">-c</span> <span class="token string">&quot;mysqldump -uadmin --password='password' --all-databases &gt; /data/backups/all-databases.sql&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在该命令中，使用 <code>--entrypoint</code> 选项，以便在容器启动后调用系统 shell，使用 <code>-c</code> 选项指定要在 shell 中运行的 <a href="/4/4.5/4.5.4/mysqldump">mysqldump</a> 命令，该命令的输出将被重定向到备份目录中的 <code>all-databases.sql</code>文件。</p> <ol start="2"><li>一旦备份作业完成，容器就会退出，并且使用 <code>--rm</code> 选项启动它，容器在退出后就会被删除。创建了一个逻辑备份，可以在用于存储备份的挂载的主机目录中找到，如下所示:</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$<span class="token operator">&gt;</span> <span class="token function">ls</span> /path-on-host-machine/backups/
all-databases.sql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><em>在 Docker 使用 <a href="/4/4.5/4.5.4/mysqldump">mysqldump</a> 恢复 MySQL 服务器数据:</em></p> <ol><li><p>确保 MySQL 服务器在容器中运行，你希望将备份数据恢复到该容器上。</p></li> <li><p>用 MySQL 服务器的镜像启动一个容器，用 MySQL 客户端执行恢复。绑定挂载服务器的数据目录，以及包含备份的存储文件夹:</p></li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$<span class="token operator">&gt;</span> <span class="token function">docker</span> run  <span class="token punctuation">\</span>
<span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/path-on-host-machine/datadir/,dst<span class="token operator">=</span>/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">--mount</span> <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/path-on-host-machine/backups/,dst<span class="token operator">=</span>/data/backups <span class="token punctuation">\</span>
<span class="token parameter variable">--rm</span> mysql/mysql-server:8.0 <span class="token punctuation">\</span>
mysql <span class="token parameter variable">-uadmin</span> <span class="token parameter variable">--password</span><span class="token operator">=</span><span class="token string">'password'</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;source /data/backups/all-databases.sql&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>一旦备份任务完成，容器就退出，并且在启动它时使用 <code>--rm</code> 选项，在它退出后将其删除。</p> <ol start="3"><li>登录到服务器，检查恢复的数据现在已经在服务器上。</li></ol> <h2 id="已知问题"><a href="#已知问题" class="header-anchor">#</a> 已知问题</h2> <p>当使用服务器系统变量 <a href="/6/6.4/6.4.5/6.4.5.11/audit-log-reference">audit_log_file</a>配置审计日志文件名时，使用 <code>loose</code> <a href="/4/4.2/4.2.2/4.2.2.4/option-modifiers">选项修饰符</a>;否则，Docker 无法启动服务器。</p> <h2 id="docker-环境变量"><a href="#docker-环境变量" class="header-anchor">#</a> Docker 环境变量</h2> <p>当你创建 MySQL 服务器容器时，你可以使用 <code>--env</code> 选项(简写形式 <code>-e</code>)并指定一个或多个环境变量来配置 MySQL 实例。如果挂载的数据目录不为空，则不执行服务器初始化，在这种情况下，设置任何这些变量都不起作用(参阅<a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#持久化数据和配置更改">持久化数据和配置更改</a>)，并且在容器启动期间不会修改目录的现有内容(包括服务器设置)。</p> <p>可以用来配置 MySQL 实例的环境变量如下:</p> <ul><li><p>布尔变量包括 <code>MYSQL_RANDOM_ROOT_PASSWORD</code>、<code>[</code>MYSQL_ONETIME_PASSWORD<code>、</code>MYSQL_ALLOW_EMPTY_PASSWORD<code>和</code>MYSQL_LOG_CONSOLE` 通过使用任何非零长度的字符串来设置它们，使其为真。因此，将它们设置为“0”、“false” 或 “no” 并不会使它们为假，而是实际上使它们为真。这是一个众所周知的问题。</p></li> <li><p><code>MYSQL_RANDOM_ROOT_PASSWORD</code>：当该变量为 true(这是它的默认状态，除非 <code>MYSQL_ROOT_PASSWORD</code> 被设置或 <code>MYSQL_ALLOW_EMPTY_PASSWORD</code> 被设置为 true)时，在 Docker 容器启动时为服务器的 root 用户生成一个随机密码。密码被打印到容器的 <code>stdout</code>，可以通过查看容器的日志找到(参阅[启动 MySQL 服务器实例](/2/2.5/2.5.6/2.5.6.2/docker-mysql-getting-started.html#启动 MySQL 服务器实例))。</p></li> <li><p><code>MYSQL_ONETIME_PASSWORD</code>：当变量为 true(这是它的默认状态，除非 <code>MYSQL_ROOT_PASSWORD</code> 被设置或 <code>MYSQL_ALLOW_EMPTY_PASSWORD</code> 被设置为 true)时，root 用户的密码被设置为过期，必须修改后 MySQL 才能正常使用。</p></li> <li><p><code>MYSQL_DATABASE</code>：这个变量允许你指定要在镜像启动时创建的数据库的名称。如果 <code>MYSQL_USER和MYSQL_PASSWORD</code> 提供了用户名和密码，则创建该用户并授予对该数据库的超级用户访问权(对应于 <code>GRANT ALL</code>)。指定的数据库是通过 <a href="/13/13.1/13.1.12/create-database">CREATE database IF NOT EXIST</a> 语句创建的，因此如果数据库已经存在，则该变量将不起作用。</p></li> <li><p><code>MYSQL_USER</code>、<code>MYSQL_PASSWORD</code>：这些变量一起用来创建一个用户并设置该用户的密码，并且该用户被授予 <code>MYSQL_DATABASE</code> 变量指定的数据库的超级用户权限。要创建用户，<code>MYSQL_USER</code> 和 <code>MYSQL_PASSWORD</code> 都是必需的——如果没有设置这两个变量中的任何一个，则忽略另一个。如果两个变量都设置了，但 <code>MYSQL_DATABASE</code> 没有设置，则创建的用户没有任何特权。</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">注意</p> <p>不需要使用这种机制来创建 root 超级用户，默认情况下创建 root 超级用户时使用的密码由 <code>MYSQL_ROOT_PASSWORD</code> 和 <code>MYSQL_RANDOM_ROOT_PASSWORD</code> 描述中讨论的任何一种机制设置，除非 <code>MYSQL_ALLOW_EMPTY_PASSWORD</code> 为 true。</p></div> <ul><li><p><code>MYSQL_ROOT_HOST</code>：默认情况下，MySQL 创建 <code>'root'@'localhost'</code> 帐户。该帐户只能从容器内连接，如<a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#从另一个-Docker-容器应用连接到-MySQL">从容器内连接 MySQL 服务器</a>中所述。若要允许来自其他主机的 root 连接，请设置此环境变量。例如，值 <code>172.17.0.1</code> 是默认的 Docker 网关 IP，它允许来自运行容器的主机的连接。该选项只接受一个条目，但是允许通配符(例如，<code>MYSQL_ROOT_HOST=172.*.*.*</code> 或 <code>MYSQL_ROOT_HOST=%</code>)。</p></li> <li><p><code>MYSQL_LOG_CONSOLE</code>：当变量为 true 时(这是 MySQL 8.0 服务器容器的默认状态)，MySQL 服务器的错误日志被重定向到 stderr，这样错误日志就会进入 Docker 容器的日志中，并且可以使用 <strong>docker logs</strong> <em>mysqld-container</em> 命令查看。</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">注意</p> <p>如果已经挂载了来自主机的服务器配置文件，则该变量将不起作用(参阅在绑定挂载配置文件时<a href="/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#持久化数据和配置更改">持久化数据和配置更改</a>)。</p></div> <ul><li><code>MYSQL_ROOT_PASSWORD</code>：该变量指定为 MySQL root 帐户设置的密码。</li></ul> <div class="custom-block warning"><p class="custom-block-title">警告</p> <p>在命令行设置 MySQL root用户密码是不安全的。作为显式指定密码的替代方法，你可以使用密码文件的容器文件路径设置变量，然后在容器文件路径上挂载主机上包含密码的文件。这仍然不是很安全，因为密码文件的位置仍然暴露在外。最好使用 <code>MYSQL_RANDOM_ROOT_PASSWORD</code> 和 <code>MYSQL_ONETIME_PASSWORD</code> 的默认设置都为 true。</p></div> <ul><li><code>MYSQL_ALLOW_EMPTY_PASSWORD</code>。将其设置为 true 将允许容器以 root 用户的空密码启动。</li></ul> <blockquote><p><a href="https://dev.mysql.com/doc/refman/8.0/en/docker-mysql-more-topics.html" target="_blank" rel="noopener noreferrer">原文链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html" class="prev">
        使用 Docker 部署 MySQL 服务器的基本步骤
      </a></span> <span class="next"><a href="/2/2.5/2.5.7/linux-installation-native.html">
        从本地软件仓库在 Linux 上安装 MySQL
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e47f27d9.js" defer></script><script src="/assets/js/2.47a142bd.js" defer></script><script src="/assets/js/105.ce774c27.js" defer></script>
  </body>
</html>
