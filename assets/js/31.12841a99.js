(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{323:function(t,s,e){"use strict";e.r(s);var r=e(13),a=Object(r.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_1-6-3-2-foreign-key-约束"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-3-2-foreign-key-约束"}},[t._v("#")]),t._v(" 1.6.3.2 FOREIGN KEY 约束")]),t._v(" "),s("p",[t._v("外键允许跨表交叉引用相关数据，"),s("RouterLink",{attrs:{to:"/glossary.html"}},[t._v("外键约束")]),t._v("有助于保持数据的一致性。")],1),t._v(" "),s("p",[t._v("MySQL 支持 "),s("RouterLink",{attrs:{to:"/13/13.1/13.1.20/create-table.html"}},[s("code",[t._v("CREATE TABLE")])]),t._v(" 和 "),s("RouterLink",{attrs:{to:"/13/13.1/13.1.9/alter-table.html"}},[s("code",[t._v("ALTER TABLE")])]),t._v(" 语句中的 "),s("code",[t._v("ON UPDATE")]),t._v(" 和 "),s("code",[t._v("ON DELETE")]),t._v(" 外键引用。可用的引用操作有 "),s("code",[t._v("RESTRICT")]),t._v("、"),s("code",[t._v("CASCADE")]),t._v("、"),s("code",[t._v("SET NULL")]),t._v(" 和 "),s("code",[t._v("NO ACTION")]),t._v("（默认值）。")],1),t._v(" "),s("p",[t._v("MySQL Server 也支持 "),s("code",[t._v("SET DEFAULT")]),t._v("，但 "),s("RouterLink",{attrs:{to:"/15/innodb-storage-engine.html"}},[s("code",[t._v("InnoDB")])]),t._v(" 目前将其视为无效而拒绝。因为 MySQL 不支持延迟约束检查，所以没有操作被视为限制。对于 MySQL 支持的外键的确切语法，参阅"),s("RouterLink",{attrs:{to:"/13/13.1/13.1.20/13.1.20.5/create-table-foreign-keys.html"}},[t._v("章节 13.1.20.5，“FOREIGN KEY 约束”")]),t._v("。")],1),t._v(" "),s("p",[t._v("允许使用 "),s("code",[t._v("MATCH FULL")]),t._v("、"),s("code",[t._v("MATCH PARTIAL")]),t._v(" 和 "),s("code",[t._v("MATCH SIMPLE")]),t._v("，但应避免使用它们，因为它们会导致 MySQL Server 忽略同一语句中使用的任何 "),s("code",[t._v("ON DELETE")]),t._v(" 或 "),s("code",[t._v("ON UPDATE")]),t._v(" 子句。"),s("code",[t._v("MATCH")]),t._v(" 选项在 MySQL 中没有任何其他效果，实际上，MySQL 全时强制执行 "),s("code",[t._v("MATCH SIMPLE")]),t._v(" 语义。")]),t._v(" "),s("p",[t._v("MySQL 要求外键列被索引；如果在给定列上创建具有外键约束但没有索引的表，则会创建索引。")]),t._v(" "),s("p",[t._v("你可以从 "),s("code",[t._v("INFORMATION_SCHEMA.KEY_COLUMN_USAGE")]),t._v(" 表中获取有关外键的信息。针对该表的查询示例如下所示：")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("mysql"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" SELECT TABLE_SCHEMA, TABLE_NAME, COLUMN_NAME, CONSTRAINT_NAME\n     "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE\n     "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" WHERE REFERENCED_TABLE_SCHEMA IS NOT NULL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n+--------------+---------------+-------------+-----------------+\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" TABLE_SCHEMA "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" TABLE_NAME    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" COLUMN_NAME "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" CONSTRAINT_NAME "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+--------------+---------------+-------------+-----------------+\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" fk1          "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" myuser        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" myuser_id   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" f               "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" fk1          "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" product_order "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" customer_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" f2              "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" fk1          "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" product_order "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" product_id  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" f1              "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+--------------+---------------+-------------+-----------------+\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" rows "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.01")]),t._v(" sec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br")])]),s("p",[s("code",[t._v("InnoDB")]),t._v(" 表上的外键信息也可以在 "),s("code",[t._v("Information_SCHEMA")]),t._v(" 数据库的 "),s("RouterLink",{attrs:{to:"/26/26.4/26.4.12/information-schema-innodb-foreign-table.html"}},[s("code",[t._v("INNODB_FOREIGN")])]),t._v(" 和 "),s("RouterLink",{attrs:{to:"/26/26.4/26.4.13/information-schema-innodb-foreign-cols-table.html"}},[s("code",[t._v("INNODB_FOREIGN_COLS")])]),t._v(" 表中找到。")],1),t._v(" "),s("p",[s("code",[t._v("InnoDB")]),t._v(" 和 "),s("code",[t._v("NDB")]),t._v(" 表支持外键。")]),t._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/constraint-foreign-key.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("原文链接"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=a.exports}}]);