(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{446:function(t,o,e){"use strict";e.r(o);var _=e(13),n=Object(_.a)({},(function(){var t=this,o=t._self._c;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("h1",{attrs:{id:"_2-11-12-升级故障排除"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_2-11-12-升级故障排除"}},[t._v("#")]),t._v(" 2.11.12 升级故障排除")]),t._v(" "),o("ul",[o("li",[t._v("MySQL 5.7 实例中表的 "),o("code",[t._v(".frm")]),t._v(" 文件和 "),o("code",[t._v("InnoDB")]),t._v(" 数据字典之间的模式不匹配可能导致 MySQL 8.0 升级失败。此类不匹配可能是由于 "),o("code",[t._v(".frm")]),t._v(" 文件损坏。要解决此问题，请在再次尝试升级之前转储并恢复受影响的表。")]),t._v(" "),o("li",[t._v("如果出现问题，例如新的 "),o("RouterLink",{attrs:{to:"/4/4.3/4.3.1/mysqld.html"}},[t._v("mysqld")]),t._v(" 服务器无法启动，请验证你没有以前安装的旧 "),o("code",[t._v("my.cnf")]),t._v(" 文件。你可以使用 "),o("RouterLink",{attrs:{to:"/4/4.2/4.2.2.3/option-file-options.html"}},[t._v("--print-defaults")]),t._v(" 选项（例如，"),o("RouterLink",{attrs:{to:"/4/4.3/4.3.1/mysqld.html"}},[t._v("mysqld --print-defaults")]),t._v("）进行检查。如果此命令显示的不是程序名，则你有一个影响服务器或客户端操作的激活的 "),o("code",[t._v("my.cnf")]),t._v(" 文件。")],1),t._v(" "),o("li",[t._v("如果在升级后，你遇到编译客户端程序的问题，例如命令不同步或意外的核心转储，那么你可能在编译程序时使用了旧的头文件或库文件。在本例中，检查 "),o("code",[t._v("mysql.h")]),t._v(" 文件和 "),o("code",[t._v("libmysqlclient.a")]),t._v(" 库的日期，以验证它们是否来自新的mysql发行版。如果没有，请使用新的头和库重新编译程序。如果库的主要版本号已更改（例如，从 "),o("code",[t._v("libmysqlclient.so.20")]),t._v(" 更改为 "),o("code",[t._v("libmysqlclient.so.21")]),t._v(" ），则针对共享客户端库编译的程序也可能需要重新编译。")]),t._v(" "),o("li",[t._v("如果你创建了一个具有给定名称的可加载函数，并将 MySQL 升级到实现同名新内置函数的版本，则可加载函数将无法访问。要更正此问题，请使用 "),o("RouterLink",{attrs:{to:"/13/13.1/13.1.26/drop-function.html"}},[t._v("DROP FUNCTION")]),t._v(" 删除可加载函数，然后使用 "),o("RouterLink",{attrs:{to:"/13/13.1/13.1.14/create-function.html"}},[t._v("CREATE FUNCTION")]),t._v(" 使用不同的非冲突名称重新创建可加载函数。如果新版本的 MySQL 实现了与现有存储函数同名的内置函数，则情况也是如此。有关描述服务器如何解释对不同类型函数的引用的规则，参阅"),o("RouterLink",{attrs:{to:"/9/9.2/9.2.5/function-resolution.html"}},[t._v("章节 9.2.5，“函数名称解析和解析”")]),t._v("。")],1),t._v(" "),o("li",[t._v("如果由于"),o("RouterLink",{attrs:{to:"/2/2.11/2.11.5/upgrade-prerequisites.html"}},[t._v("章节 2.11.5，“为升级做好安装准备”")]),t._v("中概述的任何问题导致升级到 MySQL 8.0 失败，服务器会将所有更改还原到数据目录。在这种情况下，删除所有重做日志文件，并在现有数据目录上重新启动 MySQL 5.7 服务器以解决错误。默认情况下，重做日志文件（"),o("code",[t._v("ib_logfile*")]),t._v("）位于 MySQL 数据目录中。修复错误后，在再次尝试升级之前，执行缓慢关闭（通过设置 "),o("RouterLink",{attrs:{to:"/15/15.14/innodb-parameters.html"}},[t._v("innodb_fast_shutdown=0")]),t._v("）。")],1)]),t._v(" "),o("blockquote",[o("p",[o("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/upgrade-troubleshooting.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("原文链接"),o("OutboundLink")],1)])])])}),[],!1,null,null,null);o.default=n.exports}}]);