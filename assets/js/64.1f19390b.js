(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{356:function(s,a,t){"use strict";t.r(a);var e=t(13),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_2-11-14-将-mysql-数据库复制到另一台计算机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-11-14-将-mysql-数据库复制到另一台计算机"}},[s._v("#")]),s._v(" 2.11.14 将 MySQL 数据库复制到另一台计算机")]),s._v(" "),a("p",[s._v("在需要在不同体系结构之间传输数据库的情况下，可以使用 "),a("RouterLink",{attrs:{to:"/4/4.5/4.5.4/mysqldump.html"}},[s._v("mysqldump")]),s._v(" 创建包含 SQL 语句的文件。然后，你可以将文件传输到另一台机器，并将其作为输入输入到 "),a("RouterLink",{attrs:{to:"/4/4.5/4.5.1/mysql.html"}},[s._v("mysql")]),s._v(" 客户端。")],1),s._v(" "),a("p",[s._v("使用 "),a("RouterLink",{attrs:{to:"/4/4.5/4.5.4/mysqldump.html"}},[s._v("mysqldump --help")]),s._v("查看可用的选项。")],1),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[s._v("如果在创建转储的服务器上使用了 GTID（"),a("RouterLink",{attrs:{to:"/17/17.1/17.1.6/17.1.6.5/replication-options-gtids.html"}},[s._v("gtid_mode=ON")]),s._v("），则默认情况下，"),a("RouterLink",{attrs:{to:"/4/4.5/4.5.4/mysqldump.html"}},[s._v("mysqldump")]),s._v(" 将在转储中包含 "),a("RouterLink",{attrs:{to:"/17/17.1/17.1.6/17.1.6.5/replication-options-gtids.html"}},[s._v("gtid_executed")]),s._v(" 集的内容，以将其传输到新机器。根据所涉及的 MySQL 服务器版本，此操作的结果可能会有所不同。检查 "),a("strong",[s._v("mysqldump")]),s._v(" 的 "),a("code",[s._v("--set-gtid-purged")]),s._v(" 选项的描述，以了解你正在使用的版本发生了什么，以及如果默认行为的结果不适合你的情况要如何更改行为。")],1)]),s._v(" "),a("p",[s._v("在两台计算机之间移动数据库的最简单（虽然不是最快）方法是在数据库所在的计算机上运行以下命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("mysqladmin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'other_hostname'")]),s._v(" create db_name\nmysqldump db_name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'other_hostname'")]),s._v(" db_name\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("如果要通过比较慢的网络从远程计算机复制数据库，可以使用以下命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("mysqladmin create db_name\nmysqldump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'other_hostname'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--compress")]),s._v(" db_name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql db_name\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("你还可以将转储存储在文件中，将文件传输到目标计算机，然后将文件加载到那里的数据库中。例如，可以将数据库转储到源计算机上的压缩文件，如下所示：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("mysqldump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--quick")]),s._v(" db_name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("gzip")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db_name.gz\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("将包含数据库内容的文件传输到目标计算机，并在那里运行以下命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("mysqladmin create db_name\ngunzip "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" db_name.gz "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql db_name\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("你还可以使用 "),a("RouterLink",{attrs:{to:"/4/4.5/4.5.4/mysqldump.html"}},[s._v("mysqldump")]),s._v(" 和 "),a("RouterLink",{attrs:{to:"/4/4.5/4.5.5/mysqlimport.html"}},[s._v("mysqlimport")]),s._v(" 来传输数据库。对于大型表，这比简单地使用 mysqldump 要快得多。在以下命令中，"),a("em",[s._v("DUMPDIR")]),s._v(" 表示用于存储 mysqldump 输出的目录的完整路径名。")],1),s._v(" "),a("p",[s._v("首先，为输出文件创建目录并转储数据库：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" DUMPDIR\nmysqldump "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tab")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("DUMPDIR\n   db_name\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("然后将 "),a("em",[s._v("DUMPDIR")]),s._v(" 目录中的文件传输到目标计算机上的某个相应目录，并将文件加载到 MySQL 中：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("mysqladmin create db_name           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# create database")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" DUMPDIR/*.sql "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql db_name   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# create tables in database")]),s._v("\nmysqlimport db_name\n   DUMPDIR/*.txt   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# load data into tables")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("不要忘记复制 "),a("code",[s._v("mysql")]),s._v(" 数据库，因为这是存储授权表的地方。你可能必须在新机器上以 MySQL "),a("code",[s._v("root")]),s._v(" 用户运行命令，直到 MySQL 数据库就位。\n在新机器上导入 "),a("code",[s._v("mysql")]),s._v(" 数据库后，执行 "),a("RouterLink",{attrs:{to:"/4/4.5/4.5.2/mysqladmin.html"}},[s._v("mysqladmin flush-privileges")]),s._v("，以便服务器重新加载授权表信息。")],1),s._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/copying-databases.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("原文链接"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);