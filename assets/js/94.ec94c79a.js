(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{389:function(s,a,t){"use strict";t.r(a);var e=t(13),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_2-3-5-microsoft-windows-mysql-服务器安装故障排除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-5-microsoft-windows-mysql-服务器安装故障排除"}},[s._v("#")]),s._v(" 2.3.5 Microsoft Windows MySQL 服务器安装故障排除")]),s._v(" "),a("p",[s._v("首次安装和运行 MySQL 时，你可能会遇到某些错误，导致 MySQL 服务器无法启动。本节帮助你诊断和纠正其中一些错误。")]),s._v(" "),a("p",[s._v("解决服务器问题时的第一个资源是"),a("RouterLink",{attrs:{to:"/mysql_glossary/mysql_glossary.html"}},[s._v("错误日志")]),s._v("。MySQL 服务器使用错误日志记录与阻止服务器启动的错误相关的信息。错误日志位于 "),a("code",[s._v("my.ini")]),s._v(" 文件指定的数据目录中。默认的数据目录位置是 "),a("code",[s._v("C:\\Program Files\\MySQL\\MySQL Server 8.0\\data")]),s._v("，或者在 Windows 7 和 Windows Server 2008 上是 "),a("code",[s._v("C:\\ProgramData\\MySQL")]),s._v("。默认情况下，"),a("code",[s._v("C:\\ProgramData")]),s._v(" 目录是隐藏的。你需要更改文件夹选项以查看目录和内容。有关错误日志和理解内容的更多信息，参阅"),a("RouterLink",{attrs:{to:"/5/5.4/5.4.2/error-log.html"}},[s._v("章节 5.4.2，“错误日志”")]),s._v("。")],1),s._v(" "),a("p",[s._v("有关可能错误的信息，也可参阅 MySQL 服务启动时显示的控制台消息。将 "),a("RouterLink",{attrs:{to:"/4/4.3/4.3.1/mysqld.html"}},[s._v("mysqld")]),s._v("安装为服务后，使用命令行中的 "),a("strong",[s._v("SC START")]),s._v(" "),a("em",[s._v("mysqld_service_name")]),s._v(" 或 "),a("strong",[s._v("NET START")]),s._v(" "),a("em",[s._v("mysqld_service_name")]),s._v(" 命令查看有关将 MySQL 服务器作为服务启动的任意错误消息。参阅"),a("RouterLink",{attrs:{to:"/2/2.3/2.3.4/2.3.4.8/windows-start-service.html"}},[s._v("章节 2.3.4.8，“将 MySQL 作为 Windows 服务启动”")]),s._v("。")],1),s._v(" "),a("p",[s._v("以下示例显示了安装 MySQL 并首次启动服务器时可能遇到的其他常见错误消息：")]),s._v(" "),a("ul",[a("li",[s._v("如果 MySQL 服务器找不到 MySQL 权限数据库或其他关键文件，它将显示以下消息：")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("System error "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1067")]),s._v(" has occurred.\nFatal error: Can"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t open and lock privilege tables:\nTable '")]),s._v("mysql.user"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("' doesn'")]),s._v("t exist\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("当 MySQL 基础目录或数据目录安装在与默认位置不同的位置（分别为 "),a("code",[s._v("C:\\Program Files\\MySQL\\MySQL Server 8.0")]),s._v(" 和 "),a("code",[s._v("C:\\Program Files\\MySQL\\MySQL Server 8.0\\data")]),s._v("）时，通常会出现这些消息。")]),s._v(" "),a("p",[s._v("当 MySQL 升级并安装到新位置时，可能会出现这种情况，但配置文件不会更新以反映新位置。此外，新旧配置文件可能会冲突。升级 MySQL 时，请确保删除或重命名任何旧的配置文件。")]),s._v(" "),a("p",[s._v("如果你已将 MySQL 安装到 "),a("code",[s._v("C:\\Program Files\\MySQL\\MySQL Server 8.0")]),s._v(" 以外的目录，请确保 MySQL 服务器通过使用配置（"),a("code",[s._v("my.ini")]),s._v("）文件明确这一点。把 "),a("code",[s._v("my.ini")]),s._v(" 文件放在 Windows 目录中，通常是 "),a("code",[s._v("C:\\Windows")]),s._v("。要根据 "),a("code",[s._v("WINDIR")]),s._v(" 环境变量的值确定其确切位置，请在命令提示符下发出以下命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("C:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" %WINDIR%\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("你可以使用任何文本编辑器（如记事本）创建或修改选项文件。例如，如 果MySQL 安装在 "),a("code",[s._v("E:\\MySQL")]),s._v(" 中，数据目录为 "),a("code",[s._v("D:\\MySQLdata")]),s._v("，则可以创建选项文件并设置 "),a("code",[s._v("[mysqld]")]),s._v(" 部分来指定 "),a("code",[s._v("basedir")]),s._v(" 和 "),a("code",[s._v("datadir")]),s._v(" 选项的值：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# set basedir to your installation path")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("basedir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("E:/mysql\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# set datadir to the location of your data directory")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("datadir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("D:/MySQLdata\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("在选项文件中使用（正）斜杠而不是反斜杠指定 Microsoft Windows 路径名。如果确实使用反斜杠，请将其加倍：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# set basedir to your installation path")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("basedir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("C:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Program Files"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("MySQL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("MySQL Server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# set datadir to the location of your data directory")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("datadir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("D:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("MySQLdata\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("选项文件值中使用反斜杠的规则见"),a("RouterLink",{attrs:{to:"/4/4.2/4.2.2/4.2.2.2/option-files.html"}},[s._v("章节 4.2.2.2，“使用选项文件”")]),s._v("。")],1),s._v(" "),a("p",[s._v("如果更改 MySQL 配置文件中的 "),a("code",[s._v("datadir")]),s._v(" 值，则必须在重新启动 MySQL 服务器之前移动现有 MySQL 数据目录的内容。")]),s._v(" "),a("p",[s._v("参阅"),a("RouterLink",{attrs:{to:"/2/2.3/2.3.4/2.3.4.2/windows-create-option-file.html"}},[s._v("章节 2.3.4.2，“创建选项文件”")]),s._v("。")],1),s._v(" "),a("ul",[a("li",[s._v("如果你在不首先停止和删除现有 MySQL 服务的情况下重新安装或升级 MySQL，并使用 MySQL 安装程序安装 MySQL，你可能会看到此错误：")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Error: Cannot create Windows "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" MySql. Error: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("当配置向导尝试安装服务并找到具有相同名称的现有服务时，会发生这种情况。")]),s._v(" "),a("p",[s._v("这个问题的一个解决方案是在使用配置向导时选择 "),a("code",[s._v("mysql")]),s._v(" 以外的服务名称。这样可以正确安装新服务，但保留过时的服务。虽然这是无害的，但最好删除不再使用的旧服务。")]),s._v(" "),a("p",[s._v("要永久删除旧的 "),a("code",[s._v("mysql")]),s._v(" 服务，请以具有管理权限的用户身份在命令行上执行以下命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("C:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SC DELETE mysql\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("SC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" DeleteService SUCCESS\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("如果 SC 实用程序不适用于你的 Windows 版本，请从 "),a("a",{attrs:{href:"http://www.microsoft.com/windows2000/techinfo/reskit/tools/existing/delsrv-o.asp",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://www.microsoft.com/windows2000/techinfo/reskit/tools/existing/delsrv-o.asp"),a("OutboundLink")],1),s._v(" 下载 "),a("code",[s._v("delsrv")]),s._v(" 套件并使用 "),a("code",[s._v("delsrv mysql")]),s._v(" 语法。")]),s._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/windows-troubleshooting.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("原谅链接"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=r.exports}}]);