(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{440:function(t,s,a){"use strict";a.r(s);var e=a(13),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_3-3-4-9-使用多个表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-4-9-使用多个表"}},[t._v("#")]),t._v(" 3.3.4.9 使用多个表")]),t._v(" "),s("p",[s("code",[t._v("pet")]),t._v(" 表会记录你养了哪些宠物。如果你想记录他们的其他信息，比如他们生活中的事件，比如去看兽医，或者出生时，你需要另一张桌子。这张桌子应该是什么样子的？它需要包含以下信息：")]),t._v(" "),s("ul",[s("li",[t._v("宠物的名字，这样你就可以知道每个事件都属于哪种动物。")]),t._v(" "),s("li",[t._v("一个日期，以便你知道事件发生的时间。")]),t._v(" "),s("li",[t._v("描述事件的字段。")]),t._v(" "),s("li",[t._v("事件类型字段，如果你希望能够对事件进行分类。")])]),t._v(" "),s("p",[t._v("考虑到这些因素，事件表的 "),s("RouterLink",{attrs:{to:"/13/13.1/13.1.20/create-table.html"}},[t._v("CREATE TABLE")]),t._v(" 语句可能如下所示：")],1),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("mysql"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" CREATE TABLE event "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name VARCHAR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("date")]),t._v(" DATE,\n       "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" VARCHAR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", remark VARCHAR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("与 "),s("code",[t._v("pet")]),t._v(" 表一样，通过创建包含以下信息的制表符分隔文本文件，最容易加载初始记录。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("name")]),t._v(" "),s("th",[t._v("date")]),t._v(" "),s("th",[t._v("type")]),t._v(" "),s("th",[t._v("remark")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("Fluffy")]),t._v(" "),s("td",[t._v("1995-05-15")]),t._v(" "),s("td",[t._v("litter")]),t._v(" "),s("td",[t._v("4 kittens, 3 female, 1 male")])]),t._v(" "),s("tr",[s("td",[t._v("Buffy")]),t._v(" "),s("td",[t._v("1993-06-23")]),t._v(" "),s("td",[t._v("litter")]),t._v(" "),s("td",[t._v("5 puppies, 2 female, 3 male")])]),t._v(" "),s("tr",[s("td",[t._v("Buffy")]),t._v(" "),s("td",[t._v("1994-06-19")]),t._v(" "),s("td",[t._v("litter")]),t._v(" "),s("td",[t._v("3 puppies, 3 female")])]),t._v(" "),s("tr",[s("td",[t._v("Chirpy")]),t._v(" "),s("td",[t._v("1999-03-21")]),t._v(" "),s("td",[t._v("vet")]),t._v(" "),s("td",[t._v("needed beak straightened")])]),t._v(" "),s("tr",[s("td",[t._v("Slim")]),t._v(" "),s("td",[t._v("1997-08-03")]),t._v(" "),s("td",[t._v("vet")]),t._v(" "),s("td",[t._v("broken rib")])]),t._v(" "),s("tr",[s("td",[t._v("Bowser")]),t._v(" "),s("td",[t._v("1991-10-12")]),t._v(" "),s("td",[t._v("kennel")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("Fang")]),t._v(" "),s("td",[t._v("1991-10-12")]),t._v(" "),s("td",[t._v("kennel")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("Fang")]),t._v(" "),s("td",[t._v("1998-08-28")]),t._v(" "),s("td",[t._v("birthday")]),t._v(" "),s("td",[t._v("Gave him a new chew toy")])]),t._v(" "),s("tr",[s("td",[t._v("Claws")]),t._v(" "),s("td",[t._v("1998-03-17")]),t._v(" "),s("td",[t._v("birthday")]),t._v(" "),s("td",[t._v("Gave him a new flea collar")])]),t._v(" "),s("tr",[s("td",[t._v("Whistler")]),t._v(" "),s("td",[t._v("1998-12-09")]),t._v(" "),s("td",[t._v("birthday")]),t._v(" "),s("td",[t._v("First birthday")])])])]),t._v(" "),s("p",[t._v("按如下方式加载记录：")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("mysql"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" LOAD DATA LOCAL INFILE "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'event.txt'")]),t._v(" INTO TABLE event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("根据你从 "),s("code",[t._v("pet")]),t._v(" 表上运行的查询中了解到的信息，你应该能够对事件表中的记录执行检索；原则是一样的。但什么时候 "),s("code",[t._v("event")]),t._v(" 表本身不足以回答你可能提出的问题？")]),t._v(" "),s("p",[t._v("假设你想知道每只宠物产仔的年龄。我们之前看过如何根据两个日期计算年龄。母亲的产仔日期在 "),s("code",[t._v("event")]),t._v(" 表中，但要计算她在该日期的年龄，你需要她的出生日期，该日期存储在 "),s("code",[t._v("pet")]),t._v(" 表中。这意味着查询需要两个表：")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("mysql"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" SELECT pet.name,\n       TIMESTAMPDIFF"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("YEAR,birth,date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" AS age,\n       remark\n       FROM pet INNER JOIN event\n         ON pet.name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" event.name\n       WHERE event.type "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'litter'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n+--------+------+-----------------------------+\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" name   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" age  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" remark                      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+--------+------+-----------------------------+\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Fluffy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" kittens, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" female, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" male "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Buffy  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" puppies, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" female, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" male "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Buffy  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" puppies, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" female         "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+--------+------+-----------------------------+\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("p",[t._v("关于此查询，需要注意以下几点：")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("FROM")]),t._v(" 子句连接两个表，因为查询需要从这两个表中提取信息。")])]),t._v(" "),s("li",[s("p",[t._v("组合（联接）多个表中的信息时，需要指定一个表中记录与另一个表的记录的匹配方式。这很容易，因为它们都有一个 "),s("code",[t._v("name")]),t._v(" 列。查询使用 "),s("code",[t._v("ON")]),t._v(" 子句根据 "),s("code",[t._v("name")]),t._v(" 值匹配两个表中的记录。")]),t._v(" "),s("p",[t._v("查询使用 "),s("code",[t._v("INNER JOIN")]),t._v(" 组合表。当且仅当两个表都满足 "),s("code",[t._v("ON")]),t._v(" 子句中指定的条件时，"),s("code",[t._v("INNER JOIN")]),t._v(" 允许任一表中的行出现在结果中。在本例中，"),s("code",[t._v("ON")]),t._v(" 子句指定 "),s("code",[t._v("pet")]),t._v(" 表中的 "),s("code",[t._v("name")]),t._v(" 列必须与事件表中的名称列匹配。如果某个名称出现在一个表中，而另一个表没有出现，则该行不会出现在结果中，因为 "),s("code",[t._v("ON")]),t._v(" 子句中的条件失败。")])]),t._v(" "),s("li",[s("p",[t._v("因为 "),s("code",[t._v("name")]),t._v(" 列出现在两个表中，所以在引用该列时，必须明确所指的表。这是通过在列名前加上表名来完成的。")])])]),t._v(" "),s("p",[t._v("执行联接不需要有两个不同的表。有时，如果你想将表中的记录与同一表中的其他记录进行比较，将表连接到表本身是很有用的。例如，要在你的宠物中找到繁殖配对，你可以将 "),s("code",[t._v("pet")]),t._v(" 表与自己一起生成同类物种的候选雄性和雌性：")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("mysql"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" SELECT p1.name, p1.sex, p2.name, p2.sex, p1.species\n       FROM pet AS p1 INNER JOIN pet AS p2\n         ON p1.species "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" p2.species\n         AND p1.sex "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'f'")]),t._v(" AND p1.death IS NULL\n         AND p2.sex "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'m'")]),t._v(" AND p2.death IS NULL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n+--------+------+-------+------+---------+\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" name   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" sex  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" name  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" sex  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" species "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+--------+------+-------+------+---------+\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Fluffy "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" f    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Claws "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" m    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Buffy  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" f    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Fang  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" m    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" dog     "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+--------+------+-------+------+---------+\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br")])]),s("p",[t._v("在这个查询中，我们为表名指定别名以引用列，并保持每个列引用与表的哪个实例相关联。")]),t._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/multiple-tables.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("原文链接"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);