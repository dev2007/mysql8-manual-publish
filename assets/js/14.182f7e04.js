(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{299:function(s,e,a){s.exports=a.p+"assets/img/docker-search2.b9de74eb.png"},403:function(s,e,a){"use strict";a.r(e);var t=a(13),r=Object(t.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"_2-5-6-1-使用-docker-部署-mysql-服务器的基本步骤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-6-1-使用-docker-部署-mysql-服务器的基本步骤"}},[s._v("#")]),s._v(" 2.5.6.1 使用 Docker 部署 MySQL 服务器的基本步骤")]),s._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[s._v("警告")]),s._v(" "),e("p",[s._v("MySQL 团队维护的 MySQL Docker 镜像是专门为 Linux 平台构建的。其他平台不受支持，用户在其上使用这些 MySQL Docker 镜像将自行承担风险。有关在非 Linux 操作系统上运行这些容器的一些已知限制，参阅"),e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.3/deploy-mysql-nonlinux-docker.html"}},[s._v("此处的讨论")]),s._v("。")],1)]),s._v(" "),e("ul",[e("li",[e("p",[e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html#下载-MySQL-服务器-Docker-镜像"}},[s._v("下载 MySQL 服务器 Docker 镜像")])],1)]),s._v(" "),e("li",[e("p",[e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html#启动-MySQL-服务器实例"}},[s._v("启动 MySQL 服务器实例")])],1)]),s._v(" "),e("li",[e("p",[e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html#从容器内连接到-MySQL-服务器"}},[s._v("从容器内连接到 MySQL 服务器")])],1)]),s._v(" "),e("li",[e("p",[e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html#容器-Shell-访问"}},[s._v("容器 Shell 访问")])],1)]),s._v(" "),e("li",[e("p",[e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html#停止和删除-MySQL-容器"}},[s._v("停止和删除 MySQL 容器")])],1)]),s._v(" "),e("li",[e("p",[e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html#升级-MySQL-服务器容器"}},[s._v("升级 MySQL 服务器容器")])],1)]),s._v(" "),e("li",[e("p",[e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html#有关使用-Docker-部署-MySQL-服务器的更多主题"}},[s._v("有关使用 Docker 部署 MySQL 服务器的更多主题")])],1)])]),s._v(" "),e("h2",{attrs:{id:"下载-mysql-服务器-docker-镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#下载-mysql-服务器-docker-镜像"}},[s._v("#")]),s._v(" 下载 MySQL 服务器 Docker 镜像")]),s._v(" "),e("div",{staticClass:"custom-block danger"},[e("p",{staticClass:"custom-block-title"},[s._v("重要")]),s._v(" "),e("p",[s._v("对于 MySQL 企业版用户：需要订阅才能使用MySQL企业版本的Docker映像。订阅采用自带许可证模式；有关详细信息，参阅"),e("a",{attrs:{href:"https://www.mysql.com/buy-mysql/",target:"_blank",rel:"noopener noreferrer"}},[s._v("如何购买 MySQL 产品和服务"),e("OutboundLink")],1),s._v("。")])]),s._v(" "),e("p",[s._v("在单独的步骤中下载服务器图像不是严格必要的；但是，在创建 Docker 容器之前执行此步骤可以确保本地镜像是最新的。要下载 MySQL 社区版镜像，请运行以下命令：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql/mysql-server:tag\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("tag")]),s._v(" 是要提取的镜像版本的标签（例如，"),e("code",[s._v("5.6")]),s._v("、"),e("code",[s._v("5.7")]),s._v("、"),e("code",[s._v("8.0")]),s._v(" 或 "),e("code",[s._v("latest")]),s._v("）。如果省略 "),e("code",[s._v(":tag")]),s._v("，则使用 "),e("code",[s._v("latest")]),s._v(" 标签，并下载 MySQL 社区服务器最新 GA 版本的图像。参阅"),e("a",{attrs:{href:"https://hub.docker.com/r/mysql/mysql-server/tags/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker Hub 中 mysql/mysql服务器页面"),e("OutboundLink")],1),s._v("上可用版本的标签列表。")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull container-registry.oracle.com/mysql/community-server:tag\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("要从 OCR 下载 MySQL 企业版镜像，你需要首先接受 OCR 上的许可协议，并使用 Docker 客户端登录到容器仓库：")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("访问 OCR："),e("a",{attrs:{href:"https://container-registry.oracle.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://container-registry.oracle.com/"),e("OutboundLink")],1),s._v(" 选择MySQL。")])]),s._v(" "),e("li",[e("p",[s._v("在 MySQL 仓库列表下，选择"),e("code",[s._v("企业服务器（enterprise-server）")]),s._v("。")])]),s._v(" "),e("li",[e("p",[s._v("如果你尚未登录到OCR，请单击页面右侧的"),e("code",[s._v("登录")]),s._v("按钮，然后在提示时输入你的 Oracle 帐户凭据。")])]),s._v(" "),e("li",[e("p",[s._v("按照页面右侧的说明接受许可协议。")])]),s._v(" "),e("li",[e("p",[s._v("使用 "),e("code",[s._v("docker login")]),s._v(" 命令登录 Docker 客户端的 OCR（"),e("code",[s._v("docker")]),s._v(" 命令）：")])])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker login container-registry.oracle.com ")]),s._v("\nUsername: Oracle-Account-ID\nPassword: password\nLogin successful.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("使用以下命令从 OCR下 载 MySQL 企业版 Docker 镜像：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull  container-registry.oracle.com/mysql/enterprise-server:tag\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("em",[s._v("tag")]),s._v(" 有不同的选择，对应于 OCR 提供的不同版本的 MySQL Docker 镜像：")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("8.0")]),s._v("、"),e("code",[s._v("8.0.x")]),s._v("（"),e("em",[s._v("x")]),s._v(" 是 8.0 系列中的最新版本号），"),e("code",[s._v("latest")]),s._v("：MySQL 8.0，最新 GA")]),s._v(" "),e("li",[e("code",[s._v("5.7")]),s._v("、"),e("code",[s._v("5.7.y")]),s._v("（"),e("em",[s._v("y")]),s._v(" 是 5.7 系列中的最新版本号）：MySQL 5.7")])]),s._v(" "),e("p",[s._v("要从"),e("a",{attrs:{href:"https://support.oracle.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("我的 Oracle 支持"),e("OutboundLink")],1),s._v("网站下载 MySQL 企业版镜像，请访问该网站，登录你的 Oracle 帐户，并在登录页面后执行以下步骤：")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("选择"),e("strong",[s._v("补丁和更新")]),s._v("选项卡。")])]),s._v(" "),e("li",[e("p",[s._v("转到"),e("strong",[s._v("补丁搜索")]),s._v("区域，然后在"),e("strong",[s._v("搜索")]),s._v("选项卡上切换到**产品或系列（高级）**子选项卡。")])]),s._v(" "),e("li",[e("p",[s._v("在"),e("strong",[s._v("产品")]),s._v("字段中输入“MySQL Server”，在"),e("strong",[s._v("发布")]),s._v("字段中输入所需的版本号。")])]),s._v(" "),e("li",[e("p",[s._v("使用其他过滤器的下拉列表选择"),e("strong",[s._v("描述")]),s._v("——"),e("strong",[s._v("包含")]),s._v("，并在文本字段中输入“Docker”。")])])]),s._v(" "),e("p",[s._v("下图显示了 MySQL 服务器 8.0 的 MySQL 企业版镜像的搜索设置：")]),s._v(" "),e("p",[e("img",{attrs:{src:a(299),alt:"docker-search2"}})]),s._v(" "),e("ul",[e("li",[e("p",[s._v("单击"),e("code",[s._v("搜索")]),s._v("按钮，然后从结果列表中选择所需的版本，然后单击"),e("code",[s._v("下载")]),s._v("按钮。")])]),s._v(" "),e("li",[e("p",[s._v("在出现的"),e("strong",[s._v("文件下载")]),s._v("对话框中，单击并下载 Docker 镜像的 "),e("code",[s._v(".zip")]),s._v(" 文件。")])])]),s._v(" "),e("p",[s._v("解压缩下载的 "),e("code",[s._v(".zip")]),s._v(" 压缩包以获得内部的 tarball（"),e("code",[s._v("mysql-enterprise-server-**version.tar")]),s._v("），然后通过运行以下命令加载镜像：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" load "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" mysql-enterprise-server-version.tar\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("你可以使用以下命令列出下载的 Docker 镜像：")]),s._v(" "),e("div",{staticClass:"language-bah line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("$> docker images\nREPOSITORY           TAG                 IMAGE ID            CREATED             SIZE\nmysql/mysql-server   latest              3157d7f55f8d        4 weeks ago         241MB\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h2",{attrs:{id:"启动-mysql-服务器实例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动-mysql-服务器实例"}},[s._v("#")]),s._v(" 启动 MySQL 服务器实例")]),s._v(" "),e("p",[s._v("要为 MySQL 服务器启动新的 Docker 容器，请使用以下命令：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("container_name  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),s._v(" on-failure "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" image_name:tag\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("可以使用 "),e("strong",[s._v("docker images")]),s._v(" 命令获得镜像名称，如"),e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html#下载-MySQL-服务器-Docker-镜像"}},[s._v("下载 MySQL 服务器 Docker 镜像")]),s._v("中所述。")],1),s._v(" "),e("p",[e("code",[s._v("--name")]),s._v(" 选项是可选的，用于为服务器容器提供自定义名称；如果没有提供容器名称，则生成一个随机名称。")]),s._v(" "),e("p",[e("code",[s._v("--restart")]),s._v(" 选项用于配置容器的"),e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html#下载-MySQL-服务器-Docker-镜像"}},[s._v("重启策略")]),s._v("；应将其设置为故障时的值，以支持客户端会话中的服务器重启（例如，当客户端执行重启语句或"),e("RouterLink",{attrs:{to:"/7/7.4/7.4.2/configuring-production-instances.html"}},[s._v("配置 InnoDB 集群实例")]),s._v("时）。在启用"),e("RouterLink",{attrs:{to:"/13/13.7/13.7.8/13.7.8.8/restart.html"}},[s._v("重启")]),s._v("支持的情况下，在客户端会话中发出重启会导致服务器和容器停止，然后重新启动。"),e("em",[s._v("MySQL 8.0.21 及更高版本支持服务器重启")]),s._v("。")],1),s._v(" "),e("p",[s._v("例如，要为 MySQL 社区版服务器启动一个新的 Docker 容器，请使用以下命令：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql1 "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),s._v(" on-failure "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" mysql/mysql-server:8.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("要使用从 OCR 下载的名为 MySQL 企业版服务器的 Docker 镜像来启动新的 Docker 容器，请使用以下命令：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql1 "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),s._v(" on-failure "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" container-registry.oracle.com/mysql/enterprise-server:8.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("要使用从我的 Oracle 支持下载的，名为 MySQL 企业版服务器的 Docker 镜像，来启动一个新的 Docker 容器，请使用以下命令：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql1 "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),s._v(" on-failure "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" mysql/enterprise-server:8.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("如果指定名称和标记的 Docker 镜像尚未通过早期的 "),e("strong",[s._v("docker pull")]),s._v("或 "),e("strong",[s._v("docker run")]),s._v(" 命令下载，则该镜像现在已下载。容器初始化开始，当你运行 "),e("strong",[s._v("docker ps")]),s._v(" 命令时，容器将显示在正在运行的容器列表中。例如：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\nCONTAINER ID   IMAGE                COMMAND                  CREATED             STATUS                              PORTS                NAMES\na24888f0d6f4   mysql/mysql-server   "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/entrypoint.sh my..."')]),s._v("   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" seconds ago      Up "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" seconds "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("health: starting"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("/tcp, "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("33060")]),s._v("/tcp  mysql1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("容器初始化可能需要一些时间。当服务器准备好使用时，docker ps命令输出中容器的状态从（健康：开始）更改为（健康）。\n上面 "),e("strong",[s._v("docker run")]),s._v(" 命令中使用的 "),e("code",[s._v("-d")]),s._v(" 选项使容器在后台运行。使用此命令监视容器的输出：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs mysql1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("初始化完成后，命令的输出将包含为根用户生成的随机密码；例如，使用以下命令检查密码：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs mysql1 "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&1")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" GENERATED\nGENERATED ROOT PASSWORD: Axegh3kAJyDLaRuBemecis"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("EShOs\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"从容器内连接到-mysql-服务器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#从容器内连接到-mysql-服务器"}},[s._v("#")]),s._v(" 从容器内连接到 MySQL 服务器")]),s._v(" "),e("p",[s._v("一旦服务器准备就绪，就可以在刚刚启动的 "),e("RouterLink",{attrs:{to:"/4/4.5/4.5.1/mysql.html"}},[s._v("mysql")]),s._v(" 服务器容器中运行 mysql 客户端，并将其连接到 MySQL 服务器。使用 "),e("strong",[s._v("docker exec-it")]),s._v(" 命令在已启动的 docker 容器内启动 "),e("RouterLink",{attrs:{to:"/4/4.5/4.5.1/mysql.html"}},[s._v("mysql")]),s._v(" 客户端，如下所示：")],1),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" mysql1 mysql "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-uroot")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("当询问时，输入生成的 root 密码（参阅上面"),e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html#启动-MySQL-服务器实例"}},[s._v("启动 MySQL 服务器实例")]),s._v("的最后一步，了解如何查找密码）。由于默认情况下 "),e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#Docker-环境变量"}},[s._v("MYSQL_ONETIME_PASSWORD")]),s._v(" 选项为 true，因此将 "),e("RouterLink",{attrs:{to:"/4/4.5/4.5.1/mysql.html"}},[s._v("mysql")]),s._v(" 客户端连接到服务器后，必须通过发出以下语句重置服务器根密码：")],1),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("mysql"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ALTER "),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),s._v(" IDENTIFIED BY "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'password'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("用你选择的密码替换 "),e("strong",[s._v("password")]),s._v("。重置密码后，服务器就可以使用了。")]),s._v(" "),e("h2",{attrs:{id:"容器-shell-访问"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#容器-shell-访问"}},[s._v("#")]),s._v(" 容器 Shell 访问")]),s._v(" "),e("p",[s._v("要让 shell 访问 MySQL 务器容器，请使用 "),e("code",[s._v("docker exec-it")]),s._v(" 命令在容器内启动 bash shell：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" mysql1 "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\nbash-4.2"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("然后可以在容器中运行 Linux 命令。例如，要查看容器内服务器数据目录中的内容，请使用以下命令：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("bash-4.2"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls /var/lib/mysql")]),s._v("\nauto.cnf    ca.pem\t     client-key.pem  ib_logfile0  ibdata1  mysql       mysql.sock.lock\t   private_key.pem  server-cert.pem  sys\nca-key.pem  client-cert.pem  ib_buffer_pool  ib_logfile1  ibtmp1   mysql.sock  performance_schema  public_key.pem   server-key.pem\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h2",{attrs:{id:"停止和删除-mysql-容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#停止和删除-mysql-容器"}},[s._v("#")]),s._v(" 停止和删除 MySQL 容器")]),s._v(" "),e("p",[s._v("要停止我们创建的 MySQL 服务器容器，请使用以下命令：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop mysql1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("docker stop")]),s._v(" 向 "),e("RouterLink",{attrs:{to:"/4/4.3/4.3.1/mysqld.html"}},[s._v("mysqld")]),s._v(" 进程发送一个 SIGTERM 信号，以便服务器正常关闭。")],1),s._v(" "),e("p",[s._v("还要注意，当容器的主进程（MySQL 服务器容器的情况下为 "),e("RouterLink",{attrs:{to:"/4/4.3/4.3.1/mysqld.html"}},[s._v("mysqld")]),s._v("）停止时，Docker 容器会自动停止。")],1),s._v(" "),e("p",[s._v("要再次启动MySQL服务器容器，请执行以下操作：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start mysql1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("要使用单个命令停止并重新启动MySQL服务器容器，请执行以下操作：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart mysql1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("要删除 MySQL 容器，请先停止它，然后使用 "),e("strong",[s._v("docker rm")]),s._v(" 命令：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop mysql1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" mysql1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("如果希望同时删除服务器数据目录的 Docker 卷，请在 "),e("strong",[s._v("docker rm")]),s._v(" 命令中添加 "),e("code",[s._v("-v")]),s._v(" 选项。")]),s._v(" "),e("h2",{attrs:{id:"升级-mysql-服务器容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#升级-mysql-服务器容器"}},[s._v("#")]),s._v(" 升级 MySQL 服务器容器")]),s._v(" "),e("div",{staticClass:"custom-block danger"},[e("p",{staticClass:"custom-block-title"},[s._v("重要")]),s._v(" "),e("p",[s._v("在执行任何 MySQL 升级之前，请仔细遵循"),e("RouterLink",{attrs:{to:"/2/2.11/upgrading.html"}},[s._v("章节 2.11，“升级 MySQL”")]),s._v("中的说明。在这里讨论的其他说明中，在升级之前备份数据库尤其重要。"),e("br"),s._v(" 本节中的说明要求将服务器的数据和配置保存在主机上。有关详细信息，参阅"),e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html#持久化数据和配置更改"}},[s._v("持久化数据和配置更改")]),s._v("。")],1)]),s._v(" "),e("p",[s._v("按照以下步骤将 MySQL 5.7 的 Docker 安装升级到 8.0：")]),s._v(" "),e("ul",[e("li",[s._v("停止MySQL 5.7服务器（本例中容器名为 "),e("code",[s._v("mysql57")]),s._v("）：")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop mysql57\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[e("p",[s._v("下载MySQL 8.0服务器Docker镜像。请参阅下载MySQL Server Docker映像中的说明。确保为MySQL 8.0使用正确的标记。")])]),s._v(" "),e("li",[e("p",[s._v("启动一个新的 MySQL 8.0 Docker 容器（在本例中命名为 "),e("code",[s._v("mysql80")]),s._v("），使用主机上保存的旧服务器数据和配置（如果需要进行适当修改，参阅"),e("RouterLink",{attrs:{to:"/2/2.11/upgrading.html"}},[s._v("章节 2.11，“升级 MySQL”")]),s._v("）（本例中通过"),e("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/service_create/#add-bind-mounts-or-volumes.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("绑定挂载"),e("OutboundLink")],1),s._v("）。对于 MySQL 社区版服务器，运行以下命令：")],1)])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql80 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--mount")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("type")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("bind,src"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/path-on-host-machine/my.cnf,dst"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/my.cnf "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--mount")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("type")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("bind,src"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/path-on-host-machine/datadir,dst"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" mysql/mysql-server:8.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("如果需要，将 "),e("code",[s._v("mysql/mysql-server")]),s._v(" 调整为正确的镜像名称，例如，将其替换为 "),e("code",[s._v("container-registry.oracle。com/mysql/enterprise-server")]),s._v(" 用于从 OCR 下载的 mysql 企业版镜像，或 "),e("code",[s._v("mysql/enterprise-server")]),s._v(" 用于从 "),e("a",{attrs:{href:"https://support.oracle.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("我的 Oracle 支持"),e("OutboundLink")],1),s._v("下载的 MySQL 企业版镜像。")]),s._v(" "),e("ul",[e("li",[s._v("等待服务器完成启动。你可以使用 "),e("strong",[s._v("docker ps")]),s._v(" 命令检查服务器的状态（参阅"),e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html#启动-MySQL-服务器实例"}},[s._v("启动 MySQL 服务器实例")]),s._v("以了解如何做到这一点）。")],1)]),s._v(" "),e("p",[s._v("在 8.0 系列（即从 "),e("code",[s._v("8.0.x")]),s._v(" 版升级到 "),e("code",[s._v("8.0.y")]),s._v(" 版）中，请遵循相同的步骤：停止原始容器，并在旧服务器数据和配置上使用更新的映像启动新容器。如果你在启动原始容器时使用了 "),e("code",[s._v("8.0")]),s._v(" 或 "),e("code",[s._v("latest")]),s._v("，并且现在有一个新的 MySQL 8.0 版本要升级到它，你必须首先使用以下命令为新版本拉取镜像：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql/mysql-server:8.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("然后，你可以通过在旧数据和配置上启动具有相同标记的新容器进行升级（如果你使用的是 MySQL 企业版，请调整仓库名称；参阅下载 "),e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.1/docker-mysql-getting-started.html#下载-MySQL-服务器-Docker-镜像"}},[s._v("MySQL 服务器 Docker 镜像")]),s._v("）：")],1),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql80new "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--mount")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("type")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("bind,src"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/path-on-host-machine/my.cnf,dst"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/my.cnf "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--mount")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("type")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("bind,src"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/path-on-host-machine/datadir,dst"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" mysql/mysql-server:8.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),e("p",[s._v("对于 MySQL 8.0.15 及更早版本：你需要通过在 MySQL8.0 服务器容器中运行 "),e("RouterLink",{attrs:{to:"/4/4.4/4.4.5/mysql-upgrade.html"}},[s._v("mysql_upgrade")]),s._v(" 实用程序来完成升级过程（对于 MySQL 8.0.16 及更高版本，此步骤"),e("em",[s._v("非")]),s._v("必需）：")],1),s._v(" "),e("ul",[e("li",[e("p",[s._v("docker exec -it mysql80 mysql_upgrade -uroot -p")]),s._v(" "),e("p",[s._v("出现提示时，输入旧服务器的 root 密码。")])]),s._v(" "),e("li",[e("p",[s._v("通过重新启动新容器完成升级：")]),s._v(" "),e("p",[s._v("docker restart mysql80")])])])]),s._v(" "),e("h2",{attrs:{id:"有关使用-docker-部署-mysql-服务器的更多主题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#有关使用-docker-部署-mysql-服务器的更多主题"}},[s._v("#")]),s._v(" 有关使用 Docker 部署 MySQL 服务器的更多主题")]),s._v(" "),e("p",[s._v("有关使用类似 Docker 的服务器配置部署 MySQL 服务器、持久化数据和配置、服务器错误日志和容器环境变量的更多主题，参阅"),e("RouterLink",{attrs:{to:"/2/2.5/2.5.6/2.5.6.2/docker-mysql-more-topics.html"}},[s._v("章节 2.5.6.2，“使用 Docker 部署 MySQL 服务器的更多主题”")]),s._v("。")],1),s._v(" "),e("blockquote",[e("p",[e("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/docker-mysql-getting-started.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("原文链接"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=r.exports}}]);