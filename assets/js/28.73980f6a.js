(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{320:function(e,s,t){"use strict";t.r(s);var a=t(13),r=Object(a.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"_1-6-2-4-作为备注的开头"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-2-4-作为备注的开头"}},[e._v("#")]),e._v(" 1.6.2.4 '--' 作为备注的开头")]),e._v(" "),s("p",[e._v("标准 SQL 使用 C 语法 /"),s("em",[e._v("这是注释")]),e._v("/ 表示注释，MySQL Server 也支持这种语法。MySQL 还支持对该语法的扩展，使特定于 MySQL 的 SQL 能够嵌入注释中，如"),s("RouterLink",{attrs:{to:"/9/9.7/comments.html"}},[e._v("章节 9.7，“注释”")]),e._v("所述。")],1),e._v(" "),s("p",[e._v("标准 SQL 使用“--”作为开始注释的标识。MySQL Server 使用 "),s("code",[e._v("#")]),e._v(" 作为开始注释字符。MySQL Server 还支持 "),s("code",[e._v("--comment")]),e._v(" 样式的变体。也就是说，"),s("code",[e._v("--")]),e._v(" 开始注释标识后面必须跟一个空格（或一个控制字符，如换行符）。该空格用于防止自动生成的 SQL 查询出现问题，该查询使用以下构造，其中我们自动插入 "),s("code",[e._v("payment")]),e._v(" 的值：")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("UPDATE account SET "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("credit")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("credit-payment\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("考虑 "),s("code",[e._v("payment")]),e._v(" 为负值，如 "),s("code",[e._v("-1")]),e._v(" 时，会发生什么：")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("UPDATE account SET "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("credit")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("credit--1\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[s("code",[e._v("credit--1")]),e._v(" 在 SQL 中是有效的表达式，但是 "),s("code",[e._v("--")]),e._v(" 被解释为注释的开始，表达式的一部分被丢弃。结果是一个与预期含义完全不同的语句：")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("UPDATE account SET "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("credit")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("credit\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("该语句完全不产生值的变更。这说明允许注释以 "),s("code",[e._v("--")]),e._v(" 开头可能会产生严重的后果。")]),e._v(" "),s("p",[e._v("使用我们的实现，要求紧跟 "),s("code",[e._v("--")]),e._v(" 有一个空格，以便在 MySQL Server 中将其识别为开始注释标识。因此，"),s("code",[e._v("credit--1")]),e._v(" 可以安全使用。")]),e._v(" "),s("p",[e._v("另一个安全特性是 "),s("RouterLink",{attrs:{to:"/4/4.5/4.5.1/mysql.html"}},[e._v("mysql")]),e._v(" 命令行客户端忽略以 "),s("code",[e._v("--")]),e._v(" 开头的行。")],1),e._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/ansi-diff-comments.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("原文链接"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);